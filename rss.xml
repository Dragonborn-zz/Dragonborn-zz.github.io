<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Dragonborn-zz&#39;s个人博客</title>
        <link>http://example.com</link>
        <description></description>
        <language>zh-CN</language>
        <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
        <lastBuildDate>Sun, 18 Feb 2024 03:28:48 +0000</lastBuildDate>
        <category>docker</category>
        <category>gitlab</category>
        <category>maven</category>
        <category>lombok</category>
        <category>manifold</category>
        <category>nginx</category>
        <category>android</category>
        <category>gson</category>
        <category>bug</category>
        <category>java</category>
        <category>mybatis</category>
        <category>TypeHandler</category>
        <category>PageHelper</category>
        <category>git</category>
        <category>vim</category>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/android/Gson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%97%B6%E9%97%B4long%E5%80%BC%E8%BD%AC%E4%B8%BADate%E7%B1%BB%E5%9E%8B%E6%8A%A5%E9%94%99/</guid>
            <title>Gson反序列化时间long值转为Date类型报错</title>
            <link>http://example.com/2024/02/18/android/Gson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%97%B6%E9%97%B4long%E5%80%BC%E8%BD%AC%E4%B8%BADate%E7%B1%BB%E5%9E%8B%E6%8A%A5%E9%94%99/</link>
            <category>gson</category>
            <category>bug</category>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;gson反序列化时间long值转为date类型报错即gson无法解析位数太长的时间格式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gson反序列化时间long值转为date类型报错即gson无法解析位数太长的时间格式&#34;&gt;#&lt;/a&gt; Gson 反序列化时间 long 值转为 Date 类型报错，即 Gson 无法解析位数太长的时间格式&lt;/h2&gt;
&lt;h2 id=&#34;报错日志&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#报错日志&#34;&gt;#&lt;/a&gt; 报错日志&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs log&#34;&gt;com.google.gson.JsonSyntaxException: 2022-10-21 00:00:00&lt;br&gt;at com.google.gson.internal.bind.DateTypeAdapter.deserializeToDate(DateTypeAdapter.java:87)&lt;br&gt;at com.google.gson.internal.bind.DateTypeAdapter.read(DateTypeAdapter.java:75)&lt;br&gt;at com.google.gson.internal.bind.DateTypeAdapter.read(DateTypeAdapter.java:46)&lt;br&gt;at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:131)&lt;br&gt;at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:222)&lt;br&gt;at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:131)&lt;br&gt;at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:222)&lt;br&gt;at retrofit2.converter.gson.GsonResponseBodyConverter.convert(GsonResponseBodyConverter.java:40)&lt;br&gt;at retrofit2.converter.gson.GsonResponseBodyConverter.convert(GsonResponseBodyConverter.java:27)&lt;br&gt;at retrofit2.OkHttpCall.parseResponse(OkHttpCall.java:243)&lt;br&gt;at retrofit2.OkHttpCall$1.onResponse(OkHttpCall.java:153)&lt;br&gt;at okhttp3.RealCall$AsyncCall.execute(RealCall.java:174)&lt;br&gt;at okhttp3.internal.NamedRunnable.run(NamedRunnable.java:32)&lt;br&gt;at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)&lt;br&gt;at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)&lt;br&gt;at java.lang.Thread.run(Thread.java:920)&lt;br&gt;Caused by: java.text.ParseException: Failed to parse date [&amp;quot;2022-10-21 00:00:00&amp;quot;]: Invalid time zone indicator &amp;#x27; &amp;#x27;&lt;br&gt;at com.google.gson.internal.bind.util.ISO8601Utils.parse(ISO8601Utils.java:274)&lt;br&gt;at com.google.gson.internal.bind.DateTypeAdapter.deserializeToDate(DateTypeAdapter.java:85)&lt;br&gt;at com.google.gson.internal.bind.DateTypeAdapter.read(DateTypeAdapter.java:75) &lt;br&gt;at com.google.gson.internal.bind.DateTypeAdapter.read(DateTypeAdapter.java:46) &lt;br&gt;at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:131) &lt;br&gt;at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:222) &lt;br&gt;at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:131) &lt;br&gt;at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:222) &lt;br&gt;at retrofit2.converter.gson.GsonResponseBodyConverter.convert(GsonResponseBodyConverter.java:40) &lt;br&gt;at retrofit2.converter.gson.GsonResponseBodyConverter.convert(GsonResponseBodyConverter.java:27) &lt;br&gt;at retrofit2.OkHttpCall.parseResponse(OkHttpCall.java:243) &lt;br&gt;at retrofit2.OkHttpCall$1.onResponse(OkHttpCall.java:153) &lt;br&gt;at okhttp3.RealCall$AsyncCall.execute(RealCall.java:174) &lt;br&gt;at okhttp3.internal.NamedRunnable.run(NamedRunnable.java:32) &lt;br&gt;at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167) &lt;br&gt;at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641) &lt;br&gt;at java.lang.Thread.run(Thread.java:920) &lt;br&gt;Caused by: java.lang.IndexOutOfBoundsException: Invalid time zone indicator &amp;#x27; &amp;#x27;&lt;br&gt;at com.google.gson.internal.bind.util.ISO8601Utils.parse(ISO8601Utils.java:245) &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;引发原因，返回格式解析出了问题&lt;/p&gt;
&lt;figure class=&#34;highlight reasonml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs reasonml&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Retrofit .&lt;span class=&#34;hljs-constructor&#34;&gt;Builder()&lt;/span&gt;.base&lt;span class=&#34;hljs-constructor&#34;&gt;Url(Api.BASE_URL)&lt;/span&gt;.add&lt;span class=&#34;hljs-constructor&#34;&gt;ConverterFactory(GsonConverterFactory.&lt;span class=&#34;hljs-params&#34;&gt;create&lt;/span&gt;()&lt;/span&gt;).build&lt;span class=&#34;hljs-literal&#34;&gt;()&lt;/span&gt;;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解决办法&lt;br&gt;
把 &lt;code&gt;GsonConverterFactory.create()&lt;/code&gt;  改成 &lt;code&gt;GsonConverterFactory.create(new GsonBuilder().setDateFormat(&amp;quot;yyyy-MM-dd HH:mm:ss&amp;quot;).create())&lt;/code&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/android/Retrofit2%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/</guid>
            <title>Retrofit2文件上传与下载</title>
            <link>http://example.com/2024/02/18/android/Retrofit2%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/</link>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;retrofit2文件上传与下载&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#retrofit2文件上传与下载&#34;&gt;#&lt;/a&gt; Retrofit2 文件上传与下载&lt;/h1&gt;
&lt;h3 id=&#34;文件上传包括多文件上传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件上传包括多文件上传&#34;&gt;#&lt;/a&gt; 文件上传：(包括多文件上传)&lt;/h3&gt;
&lt;h4 id=&#34;第一步创建服务返回数据的bean类此处服务器返回的是json字符串&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#第一步创建服务返回数据的bean类此处服务器返回的是json字符串&#34;&gt;#&lt;/a&gt; 第一步：创建服务返回数据的 bean 类；(此处服务器返回的是 json 字符串);&lt;/h4&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;BaseBean&lt;/span&gt;&amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; Code;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; String Msg;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; String Data;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;//...setget方法&lt;/span&gt;&lt;br&gt;&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;第二步创建用于描述网络请求的接口&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#第二步创建用于描述网络请求的接口&#34;&gt;#&lt;/a&gt; 第二步：创建用于描述网络请求的接口&lt;/h4&gt;
&lt;figure class=&#34;highlight dart&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs dart&#34;&gt;public &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;hljs-title&#34;&gt;Api&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;language-markdown&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt; 上传&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt; Multipart 这个注解代表多表单上传&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt; @param partList 表单信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt; @return .&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-emphasis&#34;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Multipart&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@POST&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;服务器地址(就创建retrofit设置的基站地址后面的具体地址)&amp;quot;&lt;/span&gt;)&lt;br&gt;Call&amp;lt;BaseBean&amp;gt; upLoading(&lt;span class=&#34;hljs-meta&#34;&gt;@Part&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;List&lt;/span&gt;&amp;lt;MultipartBody.Part&amp;gt; partList);&lt;br&gt;&lt;br&gt; &amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;第三步创建表单里面存储服务器本接口所需要的数据&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#第三步创建表单里面存储服务器本接口所需要的数据&#34;&gt;#&lt;/a&gt; 第三步：创建表单，里面存储服务器本接口所需要的数据；&lt;/h2&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;参数添加&lt;br&gt;MultipartBody.Builder builder = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; MultipartBody.&lt;span class=&#34;hljs-built_in&#34;&gt;Builder&lt;/span&gt;()&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;setType&lt;/span&gt;(MultipartBody.FORM)&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;//在这里添加服务器除了文件之外的其他参数&lt;/span&gt;&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;addFormDataPart&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;参数1&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;值1&amp;quot;&lt;/span&gt;)&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;addFormDataPart&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;参数2&amp;quot;&lt;/span&gt;, &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;值2&amp;quot;&lt;/span&gt;); &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;创建文件你需要上传到服务器的文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#创建文件你需要上传到服务器的文件&#34;&gt;#&lt;/a&gt; 创建文件 (你需要上传到服务器的文件)&lt;/h5&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;File file = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;File&lt;/span&gt;(file1Location); &lt;span class=&#34;hljs-comment&#34;&gt;//file1Location文件的路径 ,我是在手机存储根目录下创建了一个文件夹,里面放着了一张图片; &lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;设置文件的格式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#设置文件的格式&#34;&gt;#&lt;/a&gt; 设置文件的格式&lt;/h5&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;RequestBody imageBody = RequestBody.&lt;span class=&#34;hljs-built_in&#34;&gt;create&lt;/span&gt;(MediaType.&lt;span class=&#34;hljs-built_in&#34;&gt;parse&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;multipart/form-data&amp;quot;&lt;/span&gt;), file);&lt;br&gt;&lt;br&gt;   &lt;span class=&#34;hljs-comment&#34;&gt;//添加文件(uploadfile就是你服务器中需要的文件参数)&lt;/span&gt;&lt;br&gt;&lt;br&gt;   builder.&lt;span class=&#34;hljs-built_in&#34;&gt;addFormDataPart&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uploadfile&amp;quot;&lt;/span&gt;, file.&lt;span class=&#34;hljs-built_in&#34;&gt;getName&lt;/span&gt;(), imageBody); &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;生成接口需要的list&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#生成接口需要的list&#34;&gt;#&lt;/a&gt; 生成接口需要的 list&lt;/h5&gt;
&lt;figure class=&#34;highlight dart&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs dart&#34;&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;List&lt;/span&gt;&amp;lt;MultipartBody.Part&amp;gt; parts = builder.build().parts(); &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;创建设置okhttpclient&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#创建设置okhttpclient&#34;&gt;#&lt;/a&gt; 创建设置 OkHttpClient&lt;/h5&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;OkHttpClient okHttpClient = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; OkHttpClient.&lt;span class=&#34;hljs-built_in&#34;&gt;Builder&lt;/span&gt;()&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;connectTimeout&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;20&lt;/span&gt;, TimeUnit.SECONDS)&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;readTimeout&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;20&lt;/span&gt;, TimeUnit.SECONDS)&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;writeTimeout&lt;/span&gt;(&lt;span class=&#34;hljs-number&#34;&gt;20&lt;/span&gt;, TimeUnit.SECONDS)&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;//允许失败重试&lt;/span&gt;&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;retryOnConnectionFailure&lt;/span&gt;(&lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;)&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;build&lt;/span&gt;(); &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;创建retrofit实例对象&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#创建retrofit实例对象&#34;&gt;#&lt;/a&gt; 创建 retrofit 实例对象&lt;/h5&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;Retrofit retrofit = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; Retrofit.&lt;span class=&#34;hljs-built_in&#34;&gt;Builder&lt;/span&gt;()&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;//设置基站地址(基站地址+描述网络请求的接口上面注释的Post地址,就是要上传文件到服务器的地址,&lt;/span&gt;&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;// 这只是一种设置地址的方法,还有其他方式,不在赘述)&lt;/span&gt;&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;baseUrl&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;你的基站地址&amp;quot;&lt;/span&gt;)&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;//设置委托,使用OKHttp联网,也可以设置其他的;&lt;/span&gt;&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;client&lt;/span&gt;(okHttpClient)&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;//设置数据解析器,如果没有这个类需要添加依赖:&lt;/span&gt;&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;addConverterFactory&lt;/span&gt;(GsonConverterFactory.&lt;span class=&#34;hljs-built_in&#34;&gt;create&lt;/span&gt;())&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;//设置支持rxJava&lt;/span&gt;&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;// .addCallAdapterFactory(RxJava2CallAdapterFactory.create())&lt;/span&gt;&lt;br&gt;           .&lt;span class=&#34;hljs-built_in&#34;&gt;build&lt;/span&gt;(); &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;实例化请求接口把表单传递过去&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#实例化请求接口把表单传递过去&#34;&gt;#&lt;/a&gt; 实例化请求接口，把表单传递过去；&lt;/h5&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt; Call&amp;lt;BaseBean&amp;gt; call = retrofit.create(Api.class).upLoading(parts);&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;//开始请求&lt;/span&gt;&lt;br&gt;    call.enqueue(&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;Callback&lt;/span&gt;&amp;lt;BaseBean&amp;gt;() &amp;#123;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;onResponse&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(Call&amp;lt;BaseBean&amp;gt; call, Response&amp;lt;BaseBean&amp;gt; response)&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//联网有响应或有返回数据&lt;/span&gt;&lt;br&gt;            System.out.println(response.body().toString());&lt;br&gt;        &amp;#125;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;onFailure&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(Call&amp;lt;BaseBean&amp;gt; call, Throwable t)&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//连接失败,多数是网络不可用导致的&lt;/span&gt;&lt;br&gt;            System.out.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;网络不可用&amp;quot;&lt;/span&gt;);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;);&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;这就ok了单个文件上传完毕&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#这就ok了单个文件上传完毕&#34;&gt;#&lt;/a&gt; 这就 ok 了，单个文件上传完毕！！！&lt;/h3&gt;
&lt;h2 id=&#34;多文件上传以两个文件为例&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#多文件上传以两个文件为例&#34;&gt;#&lt;/a&gt; 多文件上传 (以两个文件为例)&lt;/h2&gt;
&lt;figure class=&#34;highlight cpp&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;对比一个文件,这个只需要在[设置文件的格式] 这一步,多添加一个即可;&lt;br&gt;   RequestBody imageBody = RequestBody.&lt;span class=&#34;hljs-built_in&#34;&gt;create&lt;/span&gt;(MediaType.&lt;span class=&#34;hljs-built_in&#34;&gt;parse&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;multipart/form-data&amp;quot;&lt;/span&gt;), file);&lt;br&gt;   RequestBody imageBody1 = RequestBody.&lt;span class=&#34;hljs-built_in&#34;&gt;create&lt;/span&gt;(MediaType.&lt;span class=&#34;hljs-built_in&#34;&gt;parse&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;multipart/form-data&amp;quot;&lt;/span&gt;), file1);&lt;br&gt;   &lt;span class=&#34;hljs-comment&#34;&gt;//添加文件(uploadfile就是你服务器中需要的文件参数)&lt;/span&gt;&lt;br&gt;   builder.&lt;span class=&#34;hljs-built_in&#34;&gt;addFormDataPart&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uploadfile&amp;quot;&lt;/span&gt;, file.&lt;span class=&#34;hljs-built_in&#34;&gt;getName&lt;/span&gt;(), imageBody);&lt;br&gt;   builder.&lt;span class=&#34;hljs-built_in&#34;&gt;addFormDataPart&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;uploadfile1&amp;quot;&lt;/span&gt;, file1.&lt;span class=&#34;hljs-built_in&#34;&gt;getName&lt;/span&gt;(), imageBody1); &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;接下来看文件下载ღ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#接下来看文件下载ღ&#34;&gt;#&lt;/a&gt; 接下来看文件下载ღ&lt;/h2&gt;
&lt;h1 id=&#34;文件下载&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件下载&#34;&gt;#&lt;/a&gt; 文件下载:&lt;/h1&gt;
&lt;h2 id=&#34;首先还是要在api接口创建一个方法&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#首先还是要在api接口创建一个方法&#34;&gt;#&lt;/a&gt; 首先还是要在 API 接口创建一个方法；&lt;/h2&gt;
&lt;figure class=&#34;highlight dart&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs dart&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;language-markdown&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt; 下载文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt; 如果下载大文件的一定要加上  @Streaming  注解&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt; @param fileUrl 文件的路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-bullet&#34;&gt;*&lt;/span&gt; @return 请求call&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;language-markdown&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;&lt;span class=&#34;hljs-emphasis&#34;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@GET&lt;/span&gt;&lt;br&gt;Call&amp;lt;ResponseBody&amp;gt; download(&lt;span class=&#34;hljs-meta&#34;&gt;@Url&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;String&lt;/span&gt; fileUrl); &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;然后就是创建一个retrofit对象跟上面一样由于每次创建retrofit对象会用到很多重复的代码可以抽取成一个公共方法&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#然后就是创建一个retrofit对象跟上面一样由于每次创建retrofit对象会用到很多重复的代码可以抽取成一个公共方法&#34;&gt;#&lt;/a&gt; 然后就是创建一个 retrofit 对象，跟上面一样 (由于每次创建 retrofit 对象会用到很多重复的代码，可以抽取成一个公共方法)&lt;/h3&gt;
&lt;h2 id=&#34;实例化请求接口&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#实例化请求接口&#34;&gt;#&lt;/a&gt; 实例化请求接口:&lt;/h2&gt;
&lt;p&gt;我在百度上找到一张图片，把他的地址拆分了一下，最后一个斜杠之前的 url 设置为了 baseUrl, 斜杠之后设置在这里；&lt;/p&gt;
&lt;figure class=&#34;highlight kotlin&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs kotlin&#34;&gt;地址拆分:    .baseUrl(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;https://gss3.bdstatic.com/-Po3dSag_xI4khGkpoWK1HF6hhy/baike/w%3D268%3Bg%3D0/sign=e3dc64d05a3d26972ed30f5b6dc0d5c6/&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;br&gt; &lt;span class=&#34;hljs-comment&#34;&gt;//整体地址https://gss3.bdstatic.com/Po3dSag_xI4khGkpoWK1HF6hhy/baike/w%3D268%3Bg%3D0/sign=e3dc64d05a3d26972ed30f5b6dc0d5c6/(在这里拆分了)241f95cad1c8a7868a2713146c09c93d70cf509e.jpg&lt;/span&gt;&lt;br&gt;&lt;br&gt;   Call&amp;lt;ResponseBody&amp;gt; download = retrofit.create(Api.&lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt;).download(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;241f95cad1c8a7868a2713146c09c93d70cf509e.jpg&amp;quot;&lt;/span&gt;);&lt;br&gt;   download.enqueue(new Callback&amp;lt;ResponseBody&amp;gt;() &amp;#123;&lt;br&gt;&lt;br&gt;       &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;       &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; void onResponse(Call&amp;lt;ResponseBody&amp;gt; call, Response&amp;lt;ResponseBody&amp;gt; response) &amp;#123;&lt;br&gt;           &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (response != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; response.isSuccessful()) &amp;#123;&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;// writeResponseBodyToDisk 是我写的下载保存本地工具类,可以参考一下&lt;/span&gt;&lt;br&gt;               boolean toDisk = writeResponseBodyToDisk(response.body());&lt;br&gt;               &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (toDisk) &amp;#123;&lt;br&gt;                   System.&lt;span class=&#34;hljs-keyword&#34;&gt;out&lt;/span&gt;.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;下载成功请查看&amp;quot;&lt;/span&gt;);&lt;br&gt;               &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;                   System.&lt;span class=&#34;hljs-keyword&#34;&gt;out&lt;/span&gt;.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;下载失败,请稍后重试&amp;quot;&lt;/span&gt;);&lt;br&gt;               &amp;#125;&lt;br&gt;           &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;               System.&lt;span class=&#34;hljs-keyword&#34;&gt;out&lt;/span&gt;.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;服务器返回错误&amp;quot;&lt;/span&gt;);&lt;br&gt;           &amp;#125;&lt;br&gt;       &amp;#125;&lt;br&gt;&lt;br&gt;       &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;       &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; void onFailure(Call&amp;lt;ResponseBody&amp;gt; call, Throwable t) &amp;#123;&lt;br&gt;           &lt;span class=&#34;hljs-comment&#34;&gt;//连接失败,多数是网络不可用导致的&lt;/span&gt;&lt;br&gt;           System.&lt;span class=&#34;hljs-keyword&#34;&gt;out&lt;/span&gt;.println(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;网络不可用&amp;quot;&lt;/span&gt;);&lt;br&gt;       &amp;#125;&lt;br&gt;   &amp;#125;); &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;writeresponsebodytodisk下载文件保存到本地工具类&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#writeresponsebodytodisk下载文件保存到本地工具类&#34;&gt;#&lt;/a&gt; writeResponseBodyToDisk (下载文件保存到本地工具类)&lt;/h2&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;* 下载到本地&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;* &lt;span class=&#34;hljs-doctag&#34;&gt;@param&lt;/span&gt; body 内容&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;* &lt;span class=&#34;hljs-doctag&#34;&gt;@return&lt;/span&gt; 成功或者失败&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;*/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;writeResponseBodyToDisk&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(ResponseBody body)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;//判断文件夹是否存在&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;File&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;File&lt;/span&gt;(SD_HOME_DIR);&lt;span class=&#34;hljs-comment&#34;&gt;//跟目录一个文件夹&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!files.exists()) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//不存在就创建出来&lt;/span&gt;&lt;br&gt;            files.mkdirs();&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;//创建一个文件&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;File&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;futureStudioIconFile&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;File&lt;/span&gt;(SD_HOME_DIR + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;download.jpg&amp;quot;&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;//初始化输入流&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;InputStream&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;inputStream&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;//初始化输出流&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;OutputStream&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;outputStream&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//设置每次读写的字节&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-type&#34;&gt;byte&lt;/span&gt;[] fileReader = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;byte&lt;/span&gt;[&lt;span class=&#34;hljs-number&#34;&gt;4096&lt;/span&gt;];&lt;br&gt;            &lt;span class=&#34;hljs-type&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;fileSize&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; body.contentLength();&lt;br&gt;            &lt;span class=&#34;hljs-type&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;fileSizeDownloaded&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;;&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//请求返回的字节流&lt;/span&gt;&lt;br&gt;            inputStream = body.byteStream();&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//创建输出流&lt;/span&gt;&lt;br&gt;            outputStream = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;FileOutputStream&lt;/span&gt;(futureStudioIconFile);&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//进行读取操作&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;while&lt;/span&gt; (&lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;read&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; inputStream.read(fileReader);&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (read == -&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;) &amp;#123;&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;break&lt;/span&gt;;&lt;br&gt;                &amp;#125;&lt;br&gt;                &lt;span class=&#34;hljs-comment&#34;&gt;//进行写入操作&lt;/span&gt;&lt;br&gt;                outputStream.write(fileReader, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, read);&lt;br&gt;                fileSizeDownloaded += read;&lt;br&gt;            &amp;#125;&lt;br&gt;&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//刷新&lt;/span&gt;&lt;br&gt;            outputStream.flush();&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException e) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (inputStream != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-comment&#34;&gt;//关闭输入流&lt;/span&gt;&lt;br&gt;                inputStream.close();&lt;br&gt;            &amp;#125;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (outputStream != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-comment&#34;&gt;//关闭输出流&lt;/span&gt;&lt;br&gt;                outputStream.close();&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (IOException e) &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125; &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/android/RxJava/</guid>
            <title>RxJava</title>
            <link>http://example.com/2024/02/18/android/RxJava/</link>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;rxroom&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#rxroom&#34;&gt;#&lt;/a&gt; RxRoom&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Observable&lt;/code&gt;  ：流式数据类型&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Flowable&lt;/code&gt; ：与 Observable 类似，支持背压&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Single&lt;/code&gt; ：单发数据类型，只能且必须发射一个数据&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Maybe&lt;/code&gt; ：单发数据类型，发射零个或一个数据&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Completable&lt;/code&gt; ：不发射任何数据，只通知流的结束。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;测试内存泄漏&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#测试内存泄漏&#34;&gt;#&lt;/a&gt; 测试内存泄漏&lt;/h4&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;Observable.interval(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;, TimeUnit.SECONDS)  &lt;br&gt;        .subscribeOn(Schedulers.io())  &lt;br&gt;        .observeOn(AndroidSchedulers.mainThread())  &lt;br&gt;        .subscribe(s-&amp;gt; Timber.d(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;内存泄漏测试&amp;quot;&lt;/span&gt;))&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;解决内存泄漏&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#解决内存泄漏&#34;&gt;#&lt;/a&gt; 解决内存泄漏&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;使用 CompositeDisposable&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在 Activity 中定义 CompositeDisposable&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; CompositeDisposable mCompositeDisposable;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;addSubscribe&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(Disposable disposable)&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (mCompositeDisposable == &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;&lt;br&gt;        mCompositeDisposable = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;CompositeDisposable&lt;/span&gt;();&lt;br&gt;    &amp;#125;&lt;br&gt;    mCompositeDisposable.add(disposable);&lt;br&gt;&amp;#125;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;onDestroy&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;super&lt;/span&gt;.onDestroy();&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (mCompositeDisposable != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !mCompositeDisposable.isDisposed()) &amp;#123;&lt;br&gt;        mCompositeDisposable.dispose();&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在 ViewModel 中重写&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;onCleared&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-built_in&#34;&gt;super&lt;/span&gt;.onCleared();&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (mCompositeDisposable != &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !mCompositeDisposable.isDisposed()) &amp;#123;&lt;br&gt;        mCompositeDisposable.dispose();&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;使用&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;addSubscribe(observable.subscribeOn(Schedulers.io())&lt;br&gt;                .observeOn(AndroidSchedulers.mainThread())&lt;br&gt;                .subscribe(resultBean -&amp;gt; &amp;#123;&lt;br&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (CollectionUtils.isNotEmpty(resultBean.getData())) &amp;#123;&lt;br&gt;                        adapter.addItem(resultBean.getData());&lt;br&gt;                    &amp;#125;&lt;br&gt;                &amp;#125;)&lt;br&gt;&lt;br&gt;        );&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;使用 AutoDispose&lt;br&gt;
 导入依赖&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight apache&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs apache&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;implementation&lt;/span&gt; &amp;#x27;com.uber.autodispose:autodispose-android-archcomponents:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;.&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;&amp;#x27;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;使用&lt;/p&gt;
&lt;figure class=&#34;highlight reasonml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs reasonml&#34;&gt;&lt;span class=&#34;hljs-module-access&#34;&gt;&lt;span class=&#34;hljs-module&#34;&gt;&lt;span class=&#34;hljs-identifier&#34;&gt;Observable&lt;/span&gt;.&lt;/span&gt;&lt;/span&gt;interval(&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;, TimeUnit.SECONDS)&lt;br&gt;                .subscribe&lt;span class=&#34;hljs-constructor&#34;&gt;On(Schedulers.&lt;span class=&#34;hljs-params&#34;&gt;io&lt;/span&gt;()&lt;/span&gt;)&lt;br&gt;                .observe&lt;span class=&#34;hljs-constructor&#34;&gt;On(AndroidSchedulers.&lt;span class=&#34;hljs-params&#34;&gt;mainThread&lt;/span&gt;()&lt;/span&gt;)&lt;br&gt;                .&lt;span class=&#34;hljs-keyword&#34;&gt;as&lt;/span&gt;(&lt;span class=&#34;hljs-module-access&#34;&gt;&lt;span class=&#34;hljs-module&#34;&gt;&lt;span class=&#34;hljs-identifier&#34;&gt;AutoDispose&lt;/span&gt;.&lt;/span&gt;&lt;/span&gt;auto&lt;span class=&#34;hljs-constructor&#34;&gt;Disposable(AndroidLifecycleScopeProvider.&lt;span class=&#34;hljs-params&#34;&gt;from&lt;/span&gt;(&lt;span class=&#34;hljs-params&#34;&gt;this&lt;/span&gt;)&lt;/span&gt;))&lt;br&gt;                .subscribe(s-&amp;gt; &lt;span class=&#34;hljs-module-access&#34;&gt;&lt;span class=&#34;hljs-module&#34;&gt;&lt;span class=&#34;hljs-identifier&#34;&gt;Timber&lt;/span&gt;.&lt;/span&gt;&lt;/span&gt;d(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;内存泄漏测试&amp;quot;&lt;/span&gt;));&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/java/Mybatis%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98%E5%92%8C%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8E%9F%E7%90%86%E5%8C%BA%E5%88%AB/</guid>
            <title>Mybatis一级缓存和二级缓存原理区别</title>
            <link>http://example.com/2024/02/18/java/Mybatis%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98%E5%92%8C%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8E%9F%E7%90%86%E5%8C%BA%E5%88%AB/</link>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;mybatis缓存&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#mybatis缓存&#34;&gt;#&lt;/a&gt; Mybatis 缓存&lt;/h4&gt;
&lt;p&gt;缓存就是内存中的数据，常常来自对数据库查询结果的保存，使用缓存可以避免频繁与数据库进行交互，从而提高查询响应速度。&lt;/p&gt;
&lt;p&gt;MyBatis 提供了对缓存的支持，分为一级缓存和二级缓存，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../_resources/9ca5d2eb6f80e3f84875729ba0a32164_101b6f976e2347f8b.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;我们先大致了解下 MyBatis 一级缓存与 MyBatis 二级缓存：&lt;/p&gt;
&lt;p&gt;一级缓存：SqlSession 级别的缓存，缓存的数据只在 SqlSession 内有效。&lt;/p&gt;
&lt;p&gt;二级缓存：mapper 级别的缓存，同一个 namespace 公用这一个缓存，所以对 SqlSession 是共享的，二级缓存需要我们手动开启。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;下面我们再分别详解两者的原理与区别。&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;mybatis一级缓存&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#mybatis一级缓存&#34;&gt;#&lt;/a&gt; Mybatis 一级缓存&lt;/h2&gt;
&lt;h3 id=&#34;1为什么需要mybatis一级缓存&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1为什么需要mybatis一级缓存&#34;&gt;#&lt;/a&gt; 1. 为什么需要 Mybatis 一级缓存&lt;/h3&gt;
&lt;p&gt;当我们使用 Mybatis 进行数据库的操作时候，会创建一个 SqlSession 来进行一次数据库的会话，会话结束则关闭 SqlSession 对象。&lt;/p&gt;
&lt;p&gt;如果我们很有可能多次查询完全相同的 sql 语句，每一次查询都查询一次数据库，那查询数据库代价是比较大的，这会导致系统的资源浪费。&lt;/p&gt;
&lt;p&gt;为了解决这个问题，Mybatis 对每一次会话都添加了缓存操作，不用相同的 SQL 每次都需要查询数据库，这就是 Mybatis 一级缓存的作用。&lt;/p&gt;
&lt;h3 id=&#34;2mybatis一级缓存的实现&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2mybatis一级缓存的实现&#34;&gt;#&lt;/a&gt; 2.Mybatis 一级缓存的实现&lt;/h3&gt;
&lt;p&gt;我们知道对 SqlSession 的操作，mybatis 内部都是通过 Executor 来执行的，Executor 的生命周期和 SqlSession 是一致的。&lt;/p&gt;
&lt;p&gt;Mybatis 在 Executor 中创建了&lt;a href=&#34;https://so.csdn.net/so/search?q=%E6%9C%AC%E5%9C%B0%E7%BC%93%E5%AD%98&amp;amp;spm=1001.2101.3001.7020&#34;&gt;本地缓存&lt;/a&gt; (一级缓存)，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../_resources/b9156e63163a550b0d99b11eb8ee175b_45514b2203be477a8.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;大致的流程如下：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;第一次查询用户 id 信息，先去缓存中查询是否有，如果没有，从数据库中查询用户信息，得到用户信息后在将用户信息储存到一级缓存中。&lt;/p&gt;
&lt;p&gt;如果 sqlSession 去执行 commit 操作（插入、更新、删除），清空 sqlSession 中的一级缓存，保证缓存中始终保存的是最新的信息，避免脏读。&lt;/p&gt;
&lt;p&gt;第二次查询用户 id 信息，先去缓存中查询，如缓存中有，直接从缓存中获取。&lt;/p&gt;
&lt;p&gt;注意：两次查询须在同一个 sqlsession 中完成，否则将不会走 mybatis 的一级缓存。&lt;/p&gt;
&lt;p&gt;在 mybatis 与 spring 进行整合开发时，事务控制在 service 中进行，重复调用两次 servcie 将不会走一级缓存，因为在第二次调用时 session 方法结束，SqlSession 就关闭了。&lt;/p&gt;
&lt;h3 id=&#34;3mybatis一级缓存配置&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3mybatis一级缓存配置&#34;&gt;#&lt;/a&gt; 3.Mybatis 一级缓存配置&lt;/h3&gt;
&lt;p&gt;mybatis 一级缓存的范围有 SESSION 和 STATEMENT 两种，默认是 SESSION。&lt;/p&gt;
&lt;p&gt;如果不想使用一级缓存，可以把一级缓存的范围指定为 STATEMENT，这样每次执行完一个 Mapper 中的语句后都会将一级缓存清除。&lt;/p&gt;
&lt;p&gt;如果需要更改一级缓存的范围，可以在 Mybatis 的配置文件中，在下通过 localCacheScope 指定。&lt;/p&gt;
&lt;p&gt;&amp;lt;setting name=“localCacheScope” value=“STATEMENT”/&amp;gt;&lt;/p&gt;
&lt;h2 id=&#34;mybatis二级缓存&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#mybatis二级缓存&#34;&gt;#&lt;/a&gt; Mybatis 二级缓存&lt;/h2&gt;
&lt;h3 id=&#34;1为什么需要mybatis二级缓存&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1为什么需要mybatis二级缓存&#34;&gt;#&lt;/a&gt; 1. 为什么需要 Mybatis 二级缓存？&lt;/h3&gt;
&lt;p&gt;MyBatis 一级缓存最大的共享范围就是一个 SqlSession 内部，那么如果多个 SqlSession 需要共享缓存，则需要开启二级缓存。&lt;/p&gt;
&lt;h3 id=&#34;2mybatis二级缓存的实现&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2mybatis二级缓存的实现&#34;&gt;#&lt;/a&gt; 2.Mybatis 二级缓存的实现&lt;/h3&gt;
&lt;p&gt;开启二级缓存后，会使用 CachingExecutor 装饰 Executor，进入一级缓存的查询流程前，先在 CachingExecutor 进行二级缓存的查询，具体的工作流程如下所示。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../_resources/eaf3e4a8b2e2a8b63a6cc4d9b53bf2a2_5262a034cd504d428.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;二级缓存开启后，同一个 namespace 下的所有操作语句，都影响着同一个 Cache，即二级缓存被多个 SqlSession 共享，是一个全局的变量。&lt;/p&gt;
&lt;p&gt;当开启缓存后，数据的查询执行的流程就是 二级缓存 -&amp;gt; 一级缓存 -&amp;gt; 数据库。&lt;/p&gt;
&lt;p&gt;MyBatis 是默认关闭二级缓存的，因为对于增删改操作频繁的话，那么二级缓存形同虚设，每次都会被清空缓存。&lt;/p&gt;
&lt;h2 id=&#34;mybatis一级缓存与二级缓存的区别&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#mybatis一级缓存与二级缓存的区别&#34;&gt;#&lt;/a&gt; Mybatis 一级缓存与二级缓存的区别&lt;/h2&gt;
&lt;p&gt;1）一级缓存 Mybatis 的一级缓存是指 SQLSession，一级缓存的作用域是 SQlSession, Myabits 默认开启一级缓存。&lt;/p&gt;
&lt;p&gt;在同一个 SqlSession 中，执行相同的 SQL 查询时；第一次会去查询数据库，并写在缓存中，第二次会直接从缓存中取。 当执行 SQL 时候两次查询中间发生了增删改的操作，则 SQLSession 的缓存会被清空。&lt;/p&gt;
&lt;p&gt;每次查询会先去缓存中找，如果找不到，再去数据库查询，然后把结果写到缓存中。 Mybatis 的内部缓存使用一个 HashMap，key 为 hashcode+statementId+sql 语句。Value 为查询出来的结果集映射成的 java 对象。 SqlSession 执行 insert、update、delete 等操作 commit 后会清空该 SQLSession 缓存。&lt;/p&gt;
&lt;p&gt;2） Mybatis 二级缓存是默认不开启的，作用于一个 Application，是 Mapper 级别的，多个 SqlSession 使用同一个 Mapper 的 sql 能够使用二级缓存。&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/java/lombok%E7%9A%84%E4%BD%BF%E7%94%A8/</guid>
            <title>lombok的使用</title>
            <link>http://example.com/2024/02/18/java/lombok%E7%9A%84%E4%BD%BF%E7%94%A8/</link>
            <category>lombok</category>
            <category>java</category>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;1-引入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1-引入&#34;&gt;#&lt;/a&gt; 1. 引入&lt;/h2&gt;
&lt;p&gt;java 项目引入&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs xml&#34;&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;	&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.projectlombok&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;lombok&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.18.24&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;&amp;lt;!-- Spring Boot 项目此部分可以不写 --&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Android 项目引入&lt;/p&gt;
&lt;figure class=&#34;highlight clean&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs clean&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;implementation&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;org.projectlombok:lombok:1.18.24&amp;quot;&lt;/span&gt;&lt;br&gt;annotationProcessor &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;org.projectlombok:lombok:1.18.24&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;2-配置文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2-配置文件&#34;&gt;#&lt;/a&gt; 2. 配置文件&lt;/h2&gt;
&lt;p&gt;lombok 的配置文件名为 lombok.config, 生效的作用域为其所在的目录和其子目录&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs lombok.config&#34;&gt;#指明lombok的根目录为当前配置文件所在目录&lt;br&gt;config.stopBubbling=true&lt;br&gt;# 解决子类对象属性值一致，但其继承的父类对象属性值不一致，在比较的时候会出现比较结果不对的情况&lt;br&gt;lombok.equalsAndHashCode.callSuper=call&lt;br&gt;# 使子类的toString方法包括其继承的父类对象属性值&lt;br&gt;lombok.toString.callSuper = call&lt;br&gt;#生成的set方法返回由null改为this,可以链式调用&lt;br&gt;#lombok.accessors.chain=true&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;3-注解&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3-注解&#34;&gt;#&lt;/a&gt; 3. 注解&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;注解&lt;/th&gt;
&lt;th style=&#34;text-align:right&#34;&gt;使用位置&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;使用效果&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;注解属性&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Data&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;为类的字段生成 get,set 方法，重写类的 equals,toString 和 hashCode 方法&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Value&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;字段，类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;效果相当于 java17 的 record 类&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Getter&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;字段，类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;为类的字段生成 get 方法&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Setter&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;字段，类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;为类的字段生成 set 方法&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@EqualsAndHashCode&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;重写类的 equals 和 hashCode 方法&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@ToString&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;重写类的 toString 方法&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@AllArgsConstructor&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;为类全参构造函数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@NoArgsConstructor&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;为类生成无参构造函数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@RequiredArgsConstructor&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;为类生成有参构造函数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Builder&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;自动生成构造者模式代码&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@val&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;常量声明&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;根据赋值推断出常量类型&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@var&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;变量声明&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;根据赋值推断出常量类型 (等效 java11 的 var 关键字)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@With&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;字段，类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;作用于类、变量，生成 with + 变量名的方法，返回当前对象&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@CustomLog&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;类&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;自定义日志类，生成 log 对象&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@NonNull&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;作用于成员变量和参数中，标识不能为空，否则抛出空指针异常&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Generated&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;用于标记类、变量、方法是自动生成的，没什么大用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Cleanup&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;变量&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;自动关闭资源，针对实现了 java.io.Closeable 接口的对象有效&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Synchronized&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;方法&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;作用于方法，可以替换 synchronized 关键字或 lock 锁&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@SneakyThrows&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;方法&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;作用于方法，对异常进行捕捉并抛出&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;@Singular&lt;/td&gt;
&lt;td style=&#34;text-align:right&#34;&gt;集合字段&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;作用于集合字段，需要配合 @Builder 使用，加入了 @Singular 注解后，lombok 为我们添加了一个为集合添加元素的方法&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;@CommonsLog，@Log，@JBossLog，@Log4j，@Log4j2，@Slf4j，@XSlf4j：日志注解，作用于类&lt;/p&gt;
&lt;h2 id=&#34;4-实验性注解的使用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4-实验性注解的使用&#34;&gt;#&lt;/a&gt; 4. 实验性注解的使用&lt;/h2&gt;
&lt;p&gt;@Accessors：类似于 @Builder 支持链式调用，需要配合 @Setter、@Getter 等注解使用，作用于类、变量&lt;br&gt;
 @Delegate：作用于容器变量，为该变量生成一堆常用的方法，这些方法都是容器中的方法&lt;br&gt;
 @ExtensionMethod：作用于类，向类添加方法，无需创建新的子类&lt;br&gt;
 @FieldDefaults：作用于类，定义变量的访问修饰符以及是否加 final&lt;br&gt;
@FieldNameConstants：作用于类，生成一个包含所有成员变量的内部类或者内部枚举，内部类中每个字段值即为字段名并且值不可变&lt;br&gt;
 @Helper：作用于方法内部类，使内部类中的方法暴露在外面可以被直接调用，不建议使用&lt;br&gt;
 @NonFinal：作用于类、变量，表示变量不加 final&lt;br&gt;
@PackagePrivate：作用于类和变量，相当于访问修饰符的 default，没什么用&lt;br&gt;
 @SuperBuilder：支持对于基类成员变量赋值，算是 @Builder 的升级版&lt;br&gt;
 @Tolerate：实现对冲突的兼容，作用于方法上，没什么大用，可以配合 @Builder 使用&lt;br&gt;
 @UtilityClass：作用于类，将类标记为 final，并且类、内部类中的方法、字段都标记为 static&lt;br&gt;
@WithBy3&lt;br&gt;
 六、基于 v1.18.22 版本的实验性注解&lt;br&gt;
 @StandardException：自定义异常类&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/java/springboot%E9%A1%B9%E7%9B%AE%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6spock/</guid>
            <title>springboot项目测试框架spock</title>
            <link>http://example.com/2024/02/18/java/springboot%E9%A1%B9%E7%9B%AE%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6spock/</link>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;依赖&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#依赖&#34;&gt;#&lt;/a&gt; 依赖&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pom&#34;&gt;&amp;lt;dependency&amp;gt;&lt;br&gt;    &amp;lt;groupId&amp;gt;com.china315net&amp;lt;/groupId&amp;gt;&lt;br&gt;    &amp;lt;artifactId&amp;gt;service-sales-api&amp;lt;/artifactId&amp;gt;&lt;br&gt;    &amp;lt;version&amp;gt;$&amp;#123;project.version&amp;#125;&amp;lt;/version&amp;gt;&lt;br&gt;&amp;lt;/dependency&amp;gt;&lt;br&gt;&amp;lt;dependency&amp;gt;&lt;br&gt;    &amp;lt;groupId&amp;gt;org.spockframework&amp;lt;/groupId&amp;gt;&lt;br&gt;    &amp;lt;artifactId&amp;gt;spock-spring&amp;lt;/artifactId&amp;gt;&lt;br&gt;    &amp;lt;version&amp;gt;2.4-M1-groovy-4.0&amp;lt;/version&amp;gt;&lt;br&gt;    &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;&lt;br&gt;&amp;lt;/dependency&amp;gt;&lt;br&gt;&amp;lt;dependency&amp;gt;&lt;br&gt;    &amp;lt;groupId&amp;gt;org.spockframework&amp;lt;/groupId&amp;gt;&lt;br&gt;    &amp;lt;artifactId&amp;gt;spock-core&amp;lt;/artifactId&amp;gt;&lt;br&gt;    &amp;lt;version&amp;gt;2.4-M1-groovy-4.0&amp;lt;/version&amp;gt;&lt;br&gt;    &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;&lt;br&gt;&amp;lt;/dependency&amp;gt;&lt;br&gt;&amp;lt;dependency&amp;gt;&lt;br&gt;    &amp;lt;groupId&amp;gt;org.apache.groovy&amp;lt;/groupId&amp;gt;&lt;br&gt;    &amp;lt;artifactId&amp;gt;groovy&amp;lt;/artifactId&amp;gt;&lt;br&gt;    &amp;lt;version&amp;gt;4.0.15&amp;lt;/version&amp;gt;&lt;br&gt;    &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;&lt;br&gt;&amp;lt;/dependency&amp;gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;语法&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#语法&#34;&gt;#&lt;/a&gt; 语法&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;given：输入条件（前置参数）。&lt;/li&gt;
&lt;li&gt;when：执行行为（Mock 接口、真实调用）。&lt;/li&gt;
&lt;li&gt;then：输出条件（验证结果）。&lt;/li&gt;
&lt;li&gt;and：衔接上个标签，补充的作用。&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/java/%E4%BD%BF%E7%94%A8Redission%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%88%E5%A3%B0%E6%98%8E%E5%BC%8F%EF%BC%89/</guid>
            <title>使用Redission自定义注解实现分布式锁（声明式）</title>
            <link>http://example.com/2024/02/18/java/%E4%BD%BF%E7%94%A8Redission%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%88%E5%A3%B0%E6%98%8E%E5%BC%8F%EF%BC%89/</link>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;使用redission自定义注解实现分布式锁声明式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#使用redission自定义注解实现分布式锁声明式&#34;&gt;#&lt;/a&gt; 使用 Redission 自定义注解实现分布式锁（声明式）&lt;/h1&gt;
&lt;p&gt;1. 主要依赖&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs xml&#34;&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-data-redis&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.redisson&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;redisson&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;		&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.12.1&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;配置 redission&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight reasonml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs reasonml&#34;&gt;import cn.com.yeexun.core.utils.StringUtils;&lt;br&gt;import org.redisson.Redisson;&lt;br&gt;import org.redisson.api.RedissonClient;&lt;br&gt;import org.redisson.config.Config;&lt;br&gt;import org.springframework.beans.factory.annotation.Value;&lt;br&gt;import org.springframework.context.annotation.Bean;&lt;br&gt;import org.springframework.context.annotation.Configuration;&lt;br&gt;&lt;br&gt;@Configuration&lt;br&gt;public &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; RedissionConfig &amp;#123;&lt;br&gt;    &lt;br&gt;    @&lt;span class=&#34;hljs-constructor&#34;&gt;Value(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;$&amp;#123;spring.redis.host&amp;#125;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; String host;&lt;br&gt;    &lt;br&gt;    @&lt;span class=&#34;hljs-constructor&#34;&gt;Value(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;$&amp;#123;spring.redis.port&amp;#125;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;int&lt;/span&gt; port;&lt;br&gt;    &lt;br&gt;    @&lt;span class=&#34;hljs-constructor&#34;&gt;Value(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;$&amp;#123;spring.redis.database&amp;#125;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;int&lt;/span&gt; database;&lt;br&gt;    &lt;br&gt;    @&lt;span class=&#34;hljs-constructor&#34;&gt;Value(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;$&amp;#123;spring.redis.password&amp;#125;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; String password;&lt;br&gt;&lt;br&gt;    @Bean&lt;br&gt;    public RedissonClient get&lt;span class=&#34;hljs-constructor&#34;&gt;Redisson()&lt;/span&gt; &amp;#123;&lt;br&gt;        Config config = &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-constructor&#34;&gt;Config()&lt;/span&gt;;&lt;br&gt;        config.use&lt;span class=&#34;hljs-constructor&#34;&gt;SingleServer()&lt;/span&gt;.set&lt;span class=&#34;hljs-constructor&#34;&gt;Address(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;redis://&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-params&#34;&gt;host&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-params&#34;&gt;port&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;                .set&lt;span class=&#34;hljs-constructor&#34;&gt;Database(&lt;span class=&#34;hljs-params&#34;&gt;database&lt;/span&gt;)&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;hljs-module-access&#34;&gt;&lt;span class=&#34;hljs-module&#34;&gt;&lt;span class=&#34;hljs-identifier&#34;&gt;StringUtils&lt;/span&gt;.&lt;/span&gt;&lt;/span&gt;is&lt;span class=&#34;hljs-constructor&#34;&gt;NotEmpty(&lt;span class=&#34;hljs-params&#34;&gt;password&lt;/span&gt;)&lt;/span&gt;) &amp;#123;&lt;br&gt;            config.use&lt;span class=&#34;hljs-constructor&#34;&gt;SingleServer()&lt;/span&gt;.set&lt;span class=&#34;hljs-constructor&#34;&gt;Address(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;redis://&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-params&#34;&gt;host&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-params&#34;&gt;port&lt;/span&gt;)&lt;/span&gt;.set&lt;span class=&#34;hljs-constructor&#34;&gt;Database(&lt;span class=&#34;hljs-params&#34;&gt;database&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;                    .set&lt;span class=&#34;hljs-constructor&#34;&gt;Password(&lt;span class=&#34;hljs-params&#34;&gt;password&lt;/span&gt;)&lt;/span&gt;;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            config.use&lt;span class=&#34;hljs-constructor&#34;&gt;SingleServer()&lt;/span&gt;.set&lt;span class=&#34;hljs-constructor&#34;&gt;Address(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;redis://&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-params&#34;&gt;host&lt;/span&gt; + &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; + &lt;span class=&#34;hljs-params&#34;&gt;port&lt;/span&gt;)&lt;/span&gt;.set&lt;span class=&#34;hljs-constructor&#34;&gt;Database(&lt;span class=&#34;hljs-params&#34;&gt;database&lt;/span&gt;)&lt;/span&gt;;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;//设置全局默认看门狗机续期时间,如果在使用时不设置，则使用全局的，如果全局不设置，则使用默认的30000,单位毫秒&lt;/span&gt;&lt;br&gt;        config.set&lt;span class=&#34;hljs-constructor&#34;&gt;LockWatchdogTimeout(2000)&lt;/span&gt;;&lt;br&gt;        return &lt;span class=&#34;hljs-module-access&#34;&gt;&lt;span class=&#34;hljs-module&#34;&gt;&lt;span class=&#34;hljs-identifier&#34;&gt;Redisson&lt;/span&gt;.&lt;/span&gt;&lt;/span&gt;create(config);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;自定义注解&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.validation.constraints.NotNull;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.lang.annotation.*;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.concurrent.TimeUnit;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Target(&amp;#123;ElementType.METHOD, ElementType.TYPE&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Retention(RetentionPolicy.RUNTIME)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Documented&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Inherited&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-meta&#34;&gt;@interface&lt;/span&gt; RedissionLock &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     * 分布式锁的key&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     */&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@NotNull&lt;/span&gt;&lt;br&gt;    String &lt;span class=&#34;hljs-title function_&#34;&gt;keyPrefix&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     * 类型，例如：收藏 评论等&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     */&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@NotNull&lt;/span&gt;&lt;br&gt;    String &lt;span class=&#34;hljs-title function_&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     * 获取锁等待时间（默认两秒，还没获取到锁即放弃）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     */&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-type&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;waitTime&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     * 过期时长，防止一直占用锁&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     */&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-type&#34;&gt;long&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;expire&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;default&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;10&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     * 过期时长单位&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;     */&lt;/span&gt;&lt;br&gt;    TimeUnit &lt;span class=&#34;hljs-title function_&#34;&gt;timeUnit&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;default&lt;/span&gt; TimeUnit.SECONDS;&lt;br&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;sepl 工具类&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.core.DefaultParameterNameDiscoverer;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.expression.EvaluationContext;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.expression.Expression;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.expression.ExpressionParser;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.expression.spel.standard.SpelExpressionParser;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.expression.spel.support.StandardEvaluationContext;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.lang.reflect.Method;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.Optional;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;SpElUtils&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;ExpressionParser&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;parser&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;SpelExpressionParser&lt;/span&gt;();&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;DefaultParameterNameDiscoverer&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;parameterNameDiscoverer&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;DefaultParameterNameDiscoverer&lt;/span&gt;();&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; String &lt;span class=&#34;hljs-title function_&#34;&gt;parseSpEl&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(Method method, Object[] args, String spEl)&lt;/span&gt; &amp;#123;&lt;br&gt;        String[] params = Optional.ofNullable(parameterNameDiscoverer.getParameterNames(method)).orElse(&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;String&lt;/span&gt;[]&amp;#123;&amp;#125;);&lt;span class=&#34;hljs-comment&#34;&gt;//解析参数名&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;EvaluationContext&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;context&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;StandardEvaluationContext&lt;/span&gt;();&lt;span class=&#34;hljs-comment&#34;&gt;//el解析需要的上下文对象&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;; i &amp;lt; params.length; i++) &amp;#123;&lt;br&gt;            context.setVariable(params[i], args[i]);&lt;span class=&#34;hljs-comment&#34;&gt;//所有参数都作为原材料扔进去&lt;/span&gt;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;Expression&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;expression&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; parser.parseExpression(spEl);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; expression.getValue(context, String.class);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;aop&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; cn.com.yeexun.common.redis.annotation.RedissionLock;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; cn.com.yeexun.common.redis.utils.SpElUtils;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; cn.com.yeexun.core.exception.BizException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.aspectj.lang.ProceedingJoinPoint;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.aspectj.lang.annotation.Around;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.aspectj.lang.annotation.Aspect;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.aspectj.lang.reflect.MethodSignature;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.redisson.api.RLock;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.redisson.api.RedissonClient;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.slf4j.Logger;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.slf4j.LoggerFactory;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.stereotype.Component;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; javax.annotation.Resource;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.lang.reflect.Method;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Aspect&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Component&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;RedissionAspect&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;Logger&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;logger&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; LoggerFactory.getLogger(RedissionAspect.class);&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Resource&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; RedissonClient redissonClient;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Around(&amp;quot;@annotation(redissionLock)&amp;quot;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;hljs-title function_&#34;&gt;lock&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(ProceedingJoinPoint proceedingJoinPoint, RedissionLock redissionLock)&lt;/span&gt; &amp;#123;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;Method&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;method&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; ((MethodSignature) proceedingJoinPoint.getSignature()).getMethod();&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; SpElUtils.parseSpEl(method, proceedingJoinPoint.getArgs(), redissionLock.keyPrefix());&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;lockKey&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; String.format(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;lock:%s:%s&amp;quot;&lt;/span&gt;, key, redissionLock.type());&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;RLock&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; redissonClient.getLock(lockKey);&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;boolean&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;hasLock&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;try&lt;/span&gt; &amp;#123;&lt;br&gt;            hasLock = lock.tryLock(redissionLock.waitTime(), redissionLock.expire(), redissionLock.timeUnit());&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (hasLock) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; proceedingJoinPoint.proceed();&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;catch&lt;/span&gt; (Throwable throwable) &amp;#123;&lt;br&gt;            logger.error(throwable.getMessage());&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;BizException&lt;/span&gt;(throwable.getMessage());&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;finally&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (hasLock) &amp;#123;&lt;br&gt;                lock.unlock();&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;BizException&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;获取分布式锁失败&amp;quot;&lt;/span&gt;);&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;a-idt0aa-id6_serviceimpl_190a6-serviceimpl使用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#a-idt0aa-id6_serviceimpl_190a6-serviceimpl使用&#34;&gt;#&lt;/a&gt; &lt;a id=&#34;t0&#34;&gt;&lt;/a&gt;&lt;a id=&#34;6_serviceImpl_190&#34;&gt;&lt;/a&gt;6. serviceImpl 使用&lt;/h2&gt;
&lt;figure class=&#34;highlight less&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs less&#34;&gt; &lt;span class=&#34;hljs-variable&#34;&gt;@Override&lt;/span&gt;&lt;br&gt; &lt;span class=&#34;hljs-variable&#34;&gt;@RedissionLock&lt;/span&gt;(keyPrefix = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;#contentId&amp;quot;&lt;/span&gt;, type = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;likeOrDowns&amp;quot;&lt;/span&gt;)&lt;br&gt; public void &lt;span class=&#34;hljs-built_in&#34;&gt;likeOrDowns&lt;/span&gt;(Long contentId, String type) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-comment&#34;&gt;//处理逻辑&lt;/span&gt;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/java/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/</guid>
            <title>面试总结</title>
            <link>http://example.com/2024/02/18/java/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/</link>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;mybatis一级缓存二级缓存的作用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#mybatis一级缓存二级缓存的作用&#34;&gt;#&lt;/a&gt; mybatis 一级缓存二级缓存的作用&lt;/h4&gt;
&lt;h4 id=&#34;redis-缓存雪崩解决&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#redis-缓存雪崩解决&#34;&gt;#&lt;/a&gt; redis 缓存雪崩解决&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;缓存穿透&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
当 Redis 和数据库中都没有我们想要的数据时，就需要考虑缓存穿透的问题了。下面这段逻辑大家用的会比较多：先去 Redis 中查找某资源，Redis 中查不到就去 DB 中查，DB 中查到后回写一份数据到 Redis 中。&lt;br&gt;
缓存穿透&lt;/p&gt;
&lt;p&gt;当 Redis 和数据库中都没有我们想要的数据时，就需要考虑缓存穿透的问题了。下面这段逻辑大家用的会比较多：先去 Redis 中查找某资源，Redis 中查不到就去 DB 中查，DB 中查到后回写一份数据到 Redis 中。&lt;br&gt;
&lt;em&gt;&lt;strong&gt;缓存击穿&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
试想如果所有请求对着一个 key 照死里搞，这是不是就是一种定点打击呢？&lt;/p&gt;
&lt;p&gt;怎么理解呢？举个极端的例子：比如某某明星爆出一个惊天狠料，海量吃瓜群众同时访问微博去查看该八卦新闻，而微博 Redis 集群中数据在此刻正好过期了，那么无数的请求则直接打到了微博系统的物理 DB 上，DB 瞬间挂了。&lt;/p&gt;
&lt;p&gt;解决方案：&lt;/p&gt;
&lt;p&gt;1、热点数据永远不过期&lt;/p&gt;
&lt;p&gt;比如我们可以将某个 key 的缓存时间设置为 25 小时，然后后台有个 JOB 每隔 24 小时就去批量刷新一下热点数据。就可以解决这个问题了。&lt;/p&gt;
&lt;p&gt;2、使用互斥锁&lt;/p&gt;
&lt;p&gt;容易影响吞吐量，大部分项目设置热点 key 永不过期就妥妥的了。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;缓存雪崩&lt;/strong&gt;&lt;/em&gt;&lt;br&gt;
这里的 Redis 崩了指的并不是 Redis 集群宕机了。而是说在某个时刻 Redis 集群中的热点 key 都失效了。如果集群中的热点 key 在某一时刻同时失效了的话，试想海量的请求都将直接打到 DB 上，DB 可能在瞬间就被打爆了。&lt;/p&gt;
&lt;p&gt;解决方案：&lt;br&gt;
1、Redis 失效时间加上随机数&lt;br&gt;
 Redis 失效时间加上随机数，是一种比较取巧的解决方案。在一定程度上减轻了 DB 的瞬时压力，但是这种方案也在一定程度上增加了维护的成本。&lt;/p&gt;
&lt;p&gt;2、Redis 永不过期&lt;/p&gt;
&lt;h4 id=&#34;rabbitmq消息的几种模式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#rabbitmq消息的几种模式&#34;&gt;#&lt;/a&gt; rabbitMQ 消息的几种模式&lt;/h4&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/win/%E8%84%9A%E6%9C%AC/</guid>
            <title>脚本</title>
            <link>http://example.com/2024/02/18/win/%E8%84%9A%E6%9C%AC/</link>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;获取管理员权限&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#获取管理员权限&#34;&gt;#&lt;/a&gt; 获取管理员权限&lt;/h2&gt;
&lt;figure class=&#34;highlight sqf&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs sqf&#34;&gt;@ &lt;span class=&#34;hljs-built_in&#34;&gt;echo&lt;/span&gt; off&lt;br&gt;%&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt; %&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;&lt;br&gt;ver|&lt;span class=&#34;hljs-built_in&#34;&gt;find&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;5.&amp;quot;&lt;/span&gt;&amp;gt;nul&amp;amp;&amp;amp;&lt;span class=&#34;hljs-built_in&#34;&gt;goto&lt;/span&gt; :&lt;span class=&#34;hljs-built_in&#34;&gt;Admin&lt;/span&gt;&lt;br&gt;mshta vbscript:createobject(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;shell.application&amp;quot;&lt;/span&gt;).shellexecute(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%~s0&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;goto :Admin&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;runas&amp;quot;&lt;/span&gt;,&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)(window.close)&amp;amp;&lt;span class=&#34;hljs-built_in&#34;&gt;goto&lt;/span&gt; :eof&lt;br&gt;:&lt;span class=&#34;hljs-built_in&#34;&gt;Admin&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;关闭指定接口&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#关闭指定接口&#34;&gt;#&lt;/a&gt; 关闭指定接口&lt;/h2&gt;
&lt;figure class=&#34;highlight routeros&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs routeros&#34;&gt;@echo off&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;set&lt;/span&gt; /p &lt;span class=&#34;hljs-attribute&#34;&gt;var1&lt;/span&gt;=please input port: &lt;br&gt;netstat -nao | findstr &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;%var1%&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-built_in&#34;&gt;set&lt;/span&gt; /p &lt;span class=&#34;hljs-attribute&#34;&gt;var2&lt;/span&gt;=please input pid: &lt;br&gt;taskkill -pid %var2% -f&lt;br&gt;pause&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;设置环境变量&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#设置环境变量&#34;&gt;#&lt;/a&gt; 设置环境变量&lt;/h2&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;setx &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;JAVA_HOME&amp;quot;&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;xxx&amp;quot;&lt;/span&gt; /m&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</guid>
            <title>正则表达式</title>
            <link>http://example.com/2024/02/18/%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</link>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;h3 id=&#34;替换&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#替换&#34;&gt;#&lt;/a&gt; 替换&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mtext&gt;全部字符&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;0 全部字符
&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6833em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;全部字符&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;n 第 n 个捕获组&lt;br&gt;
 \U 将匹配项转为大写 (Upper)&lt;br&gt;
\L 将匹配项转为小写 (Lower)&lt;br&gt;
\E 终止转换 (End)&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/18/android/Android%E5%90%84%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E7%9A%84SDK%E5%8F%8AJDK%E7%89%88%E6%9C%AC%E8%A6%81%E6%B1%82/</guid>
            <title>Android各版本对应的SDK及JDK版本要求</title>
            <link>http://example.com/2024/02/18/android/Android%E5%90%84%E7%89%88%E6%9C%AC%E5%AF%B9%E5%BA%94%E7%9A%84SDK%E5%8F%8AJDK%E7%89%88%E6%9C%AC%E8%A6%81%E6%B1%82/</link>
            <category>android</category>
            <pubDate>Sun, 18 Feb 2024 03:28:48 +0000</pubDate>
            <description><![CDATA[ &lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;平台版本&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;SDK 版本&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;版本名称&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;JDK 版本&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 13.0&lt;/td&gt;
&lt;td&gt;33&lt;/td&gt;
&lt;td&gt;T&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 12.0&lt;/td&gt;
&lt;td&gt;31&lt;/td&gt;
&lt;td&gt;S&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 11.0&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;R&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 10.0&lt;/td&gt;
&lt;td&gt;29&lt;/td&gt;
&lt;td&gt;Q&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 9.0&lt;/td&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;Pie&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 8.1&lt;/td&gt;
&lt;td&gt;27&lt;/td&gt;
&lt;td&gt;Oreo&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 8.0&lt;/td&gt;
&lt;td&gt;26&lt;/td&gt;
&lt;td&gt;Oreo&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 7.1&lt;/td&gt;
&lt;td&gt;25&lt;/td&gt;
&lt;td&gt;Nougat&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 7.0&lt;/td&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;Nougat&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 6.0&lt;/td&gt;
&lt;td&gt;23&lt;/td&gt;
&lt;td&gt;Marshmallow&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 5.1&lt;/td&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;Lollipop&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 5.0&lt;/td&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;Lollipop&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 4.4&lt;/td&gt;
&lt;td&gt;19&lt;/td&gt;
&lt;td&gt;KITKAT&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 4.3&lt;/td&gt;
&lt;td&gt;18&lt;/td&gt;
&lt;td&gt;JELLY_BEAN_MR2&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 4.2, 4.2.2&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;JELLY_BEAN_MR1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 4.1, 4.1.1&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;JELLY_BEAN&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 4.0.3, 4.0.4&lt;/td&gt;
&lt;td&gt;15&lt;/td&gt;
&lt;td&gt;ICE_CREAM_SANDWICH_MR1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 4.0, 4.0.1, 4.0.2&lt;/td&gt;
&lt;td&gt;14&lt;/td&gt;
&lt;td&gt;ICE_CREAM_SANDWICH&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 3.2&lt;/td&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;HONEYCOMB_MR2&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 3.1.x&lt;/td&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;HONEYCOMB_MR1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 3.0.x&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;HONEYCOMB&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.3.4&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;GINGERBREAD_MR1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.3.3&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;GINGERBREAD_MR1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.3.2&lt;/td&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;GINGERBREAD&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.3.1&lt;/td&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;GINGERBREAD&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.3&lt;/td&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;GINGERBREAD&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.2.x&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;FROYO&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.1.x&lt;/td&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;ECLAIR_MR1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.0.1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;ECLAIR_0_1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 2.0&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;ECLAIR&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 1.6&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;DONUT&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 1.5&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;CUPCAKE&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 1.1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;BASE_1_1&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Android 1.0&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;BASE&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Java 代码混淆工具 ProGuard 对应 jdk 关系&lt;/p&gt;
&lt;p&gt;45 = Java 1.1&lt;br&gt;
46 = Java 1.2&lt;br&gt;
47 = Java 1.3&lt;br&gt;
48 = Java 1.4&lt;br&gt;
49 = Java 5&lt;br&gt;
50 = Java 6&lt;br&gt;
51 = Java 7&lt;br&gt;
52 = Java 8&lt;br&gt;
53 = Java 9&lt;br&gt;
54 = Java 10&lt;br&gt;
55 = Java 11&lt;br&gt;
56 = Java 12&lt;br&gt;
57 = Java 13&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/06/%E5%B7%A5%E5%85%B7/vim%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</guid>
            <title>vim常用命令</title>
            <link>http://example.com/2024/02/06/%E5%B7%A5%E5%85%B7/vim%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</link>
            <category>vim</category>
            <pubDate>Tue, 06 Feb 2024 09:40:01 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;vim-键盘图&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#vim-键盘图&#34;&gt;#&lt;/a&gt; vim 键盘图&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://www.runoob.com/wp-content/uploads/2015/10/vi-vim-cheat-sheet-sch.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;vivim-的使用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#vivim-的使用&#34;&gt;#&lt;/a&gt; vi/vim 的使用&lt;/h2&gt;
&lt;p&gt;基本上 vi/vim 共分为三种模式，&lt;strong&gt;命令模式（Command Mode）、输入模式（Insert Mode）和命令行模式（Command-Line Mode）&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id=&#34;命令模式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#命令模式&#34;&gt;#&lt;/a&gt; 命令模式&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;用户刚刚启动 vi/vim，便进入了命令模式。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;此状态下敲击键盘动作会被 Vim 识别为命令，而非输入字符，比如我们此时按下 i，并不会输入一个字符，i 被当作了一个命令。&lt;/p&gt;
&lt;p&gt;以下是普通模式常用的几个命令：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;i – 切换到输入模式，在光标当前位置开始输入文本。&lt;/li&gt;
&lt;li&gt;x – 删除当前光标所在处的字符。&lt;/li&gt;
&lt;li&gt;: – 切换到底线命令模式，以在最底一行输入命令。&lt;/li&gt;
&lt;li&gt;a – 进入插入模式，在光标下一个位置开始输入文本。&lt;/li&gt;
&lt;li&gt;o：在当前行的下方插入一个新行，并进入插入模式。&lt;/li&gt;
&lt;li&gt;O – 在当前行的上方插入一个新行，并进入插入模式。&lt;/li&gt;
&lt;li&gt;dd – 删除当前行。&lt;/li&gt;
&lt;li&gt;yy – 复制当前行。&lt;/li&gt;
&lt;li&gt;p – 粘贴剪贴板内容到光标下方。&lt;/li&gt;
&lt;li&gt;P – 粘贴剪贴板内容到光标上方。&lt;/li&gt;
&lt;li&gt;u – 撤销上一次操作。&lt;/li&gt;
&lt;li&gt;Ctrl + r – 重做上一次撤销的操作。&lt;/li&gt;
&lt;li&gt;:w – 保存文件。&lt;/li&gt;
&lt;li&gt;:q – 退出 Vim 编辑器。&lt;/li&gt;
&lt;li&gt;:q! – 强制退出 Vim 编辑器，不保存修改。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;若想要编辑文本，只需要启动 Vim，进入了命令模式，按下 i 切换到输入模式即可。&lt;/p&gt;
&lt;p&gt;命令模式只有一些最基本的命令，因此仍要依靠&lt;strong&gt;底线命令行模式&lt;/strong&gt;输入更多命令。&lt;/p&gt;
&lt;h3 id=&#34;输入模式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#输入模式&#34;&gt;#&lt;/a&gt; 输入模式&lt;/h3&gt;
&lt;p&gt;在命令模式下按下 i 就进入了输入模式，使用 Esc 键可以返回到普通模式。&lt;/p&gt;
&lt;p&gt;在输入模式中，可以使用以下按键：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;字符按键以及 Shift 组合&lt;/strong&gt;，输入字符&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ENTER&lt;/strong&gt;，回车键，换行&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BACK SPACE&lt;/strong&gt;，退格键，删除光标前一个字符&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DEL&lt;/strong&gt;，删除键，删除光标后一个字符&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;方向键&lt;/strong&gt;，在文本中移动光标&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HOME&lt;/strong&gt;/&lt;strong&gt;END&lt;/strong&gt;，移动光标到行首 / 行尾&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Page Up&lt;/strong&gt;/&lt;strong&gt;Page Down&lt;/strong&gt;，上 / 下翻页&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Insert&lt;/strong&gt;，切换光标为输入 / 替换模式，光标将变成竖线 / 下划线&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ESC&lt;/strong&gt;，退出输入模式，切换到命令模式&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;底线命令模式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#底线命令模式&#34;&gt;#&lt;/a&gt; 底线命令模式&lt;/h3&gt;
&lt;p&gt;在命令模式下按下 :（英文冒号）就进入了底线命令模式。&lt;/p&gt;
&lt;p&gt;底线命令模式可以输入单个或多个字符的命令，可用的命令非常多。&lt;/p&gt;
&lt;p&gt;在底线命令模式中，基本的命令有（已经省略了冒号）：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;:w&lt;/code&gt; ：保存文件。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:q&lt;/code&gt; ：退出 Vim 编辑器。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:wq&lt;/code&gt; ：保存文件并退出 Vim 编辑器。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;:q!&lt;/code&gt; ：强制退出 Vim 编辑器，不保存修改。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;按 ESC 键可随时退出底线命令模式。&lt;/p&gt;
&lt;p&gt;简单的说，我们可以将这三个模式想成底下的图标来表示：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;../_resources/vim-vi-workmodel_52de27b995914cba974754e535802695.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;第一部分一般模式可用的光标移动-复制粘贴-搜索替换等&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#第一部分一般模式可用的光标移动-复制粘贴-搜索替换等&#34;&gt;#&lt;/a&gt; 第一部分：一般模式可用的光标移动、复制粘贴、搜索替换等&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;移动光标的方法&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;h 或 向左箭头键 (←)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标向左移动一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;j 或 向下箭头键 (↓)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标向下移动一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;k 或 向上箭头键 (↑)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标向上移动一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;l 或 向右箭头键 (→)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标向右移动一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;[Ctrl] + [f]&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;屏幕『向下』移动一页，相当于 [Page Down] 按键 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;[Ctrl] + [b]&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;屏幕『向上』移动一页，相当于 [Page Up] 按键 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;[Ctrl] + [d]&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;屏幕『向下』移动半页&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;[Ctrl] + [u]&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;屏幕『向上』移动半页&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;+&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标移动到非空格符的下一行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标移动到非空格符的上一行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;n&amp;lt;space&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;那个 n 表示『数字』，例如 20 。按下数字后再按空格键，光标会向右移动这一行的 n 个字符。例如 20&amp;lt;space&amp;gt; 则光标会向后面移动 20 个字符距离。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;0 或功能键 [Home]&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;这是数字『 0 』：移动到这一行的最前面字符处 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;$ 或功能键 [End]&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;移动到这一行的最后面字符处 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;H&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标移动到这个屏幕的最上方那一行的第一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;M&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标移动到这个屏幕的中央那一行的第一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;L&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;光标移动到这个屏幕的最下方那一行的第一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;G&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;移动到这个档案的最后一行 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;nG&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;n 为数字。移动到这个档案的第 n 行。例如 20G 则会移动到这个档案的第 20 行 (可配合 :set nu)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;gg&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;移动到这个档案的第一行，相当于 1G 啊！ (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;n&amp;lt;Enter&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;n 为数字。光标向下移动 n 行 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;** 搜索替换 **&lt;br&gt;
| /word | 向光标之下寻找一个名称为 word 的字符串。例如要在档案内搜寻 vbird 这个字符串，就输入 /vbird 即可！ (常用) |&lt;br&gt;
| ?word | 向光标之上寻找一个字符串名称为 word 的字符串。 |&lt;br&gt;
| n | 这个 n 是英文按键。代表重复前一个搜寻的动作。举例来说， 如果刚刚我们执行 /vbird 去向下搜寻 vbird 这个字符串，则按下 n 后，会向下继续搜寻下一个名称为 vbird 的字符串。如果是执行？vbird 的话，那么按下 n 则会向上继续搜寻名称为 vbird 的字符串！ |&lt;br&gt;
| N | 这个 N 是英文按键。与 n 刚好相反，为『反向』进行前一个搜寻动作。 例如 /vbird 后，按下 N 则表示『向上』搜寻 vbird 。 |&lt;br&gt;
| 使用 /word 配合 n 及 N 是非常有帮助的！可以让你重复的找到一些你搜寻的关键词！ | |&lt;br&gt;
| :n1,n2s/word1/word2/g | n1 与 n2 为数字。在第 n1 与 n2 行之间寻找 word1 这个字符串，并将该字符串取代为 word2 ！举例来说，在 100 到 200 行之间搜寻 vbird 并取代为 VBIRD 则：&lt;br&gt;
『:100,200s/vbird/VBIRD/g』。(常用) |&lt;br&gt;
| :1,&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mtext&gt;或&lt;/mtext&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;s/word1/word2/g 或 :%s/word1/word2/g | 从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！(常用) | | :1,&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;or&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1/&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02691em;&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;or&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2/&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;或&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;s/word1/word2/gc 或 :% s/word1/word2/gc | 从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！且在取代前显示提示字符给用户确认 (confirm) 是否需要取代！(常用) |&lt;br&gt;
| 删除、复制与贴上 | |&lt;br&gt;
| x, X | 在一行字当中，x 为向后删除一个字符 (相当于 [del] 按键)， X 为向前删除一个字符 (相当于 [backspace] 亦即是退格键) (常用) |&lt;br&gt;
| nx | n 为数字，连续向后删除 n 个字符。举例来说，我要连续删除 10 个字符， 『10x』。 |&lt;br&gt;
| dd | 剪切游标所在的那一整行 (常用)，用 p/P 可以粘贴。 |&lt;br&gt;
| ndd | n 为数字。剪切光标所在的向下 n 行，例如 20dd 则是剪切 20 行 (常用)，用 p/P 可以粘贴。 |&lt;br&gt;
| d1G | 删除光标所在到第一行的所有数据 |&lt;br&gt;
| dG | 删除光标所在到最后一行的所有数据 |&lt;br&gt;
| d$ | 删除游标所在处，到该行的最后一个字符 |&lt;br&gt;
| d0 | 那个是数字的 0 ，删除游标所在处，到该行的最前面一个字符 |&lt;br&gt;
| yy | 复制游标所在的那一行 (常用) |&lt;br&gt;
| nyy | n 为数字。复制光标所在的向下 n 行，例如 20yy 则是复制 20 行 (常用) |&lt;br&gt;
| y1G | 复制游标所在行到第一行的所有数据 |&lt;br&gt;
| yG | 复制游标所在行到最后一行的所有数据 |&lt;br&gt;
| y0 | 复制光标所在的那个字符到该行行首的所有数据 |&lt;br&gt;
| y$ | 复制光标所在的那个字符到该行行尾的所有数据 |&lt;br&gt;
| p, P | p 为将已复制的数据在光标下一行贴上，P 则为贴在游标上一行！ 举例来说，我目前光标在第 20 行，且已经复制了 10 行数据。则按下 p 后， 那 10 行数据会贴在原本的 20 行之后，亦即由 21 行开始贴。但如果是按下 P 呢？ 那么原本的第 20 行会被推到变成 30 行。 (常用) |&lt;br&gt;
| J | 将光标所在行与下一行的数据结合成同一行 |&lt;br&gt;
| c | 重复删除多个数据，例如向下删除 10 行，[10cj] |&lt;br&gt;
| u | 复原前一个动作。(常用) |&lt;br&gt;
| [Ctrl]+r | 重做上一个动作。(常用) |&lt;br&gt;
| . | 不要怀疑！这就是小数点！意思是重复前一个动作的意思。 如果你想要重复删除、重复贴上等等动作，按下小数点『.』就好了！ (常用) |&lt;br&gt;
| 如果你将右手放在键盘上的话，你会发现 hjkl 是排列在一起的，因此可以使用这四个按钮来移动光标。 如果想要进行多次移动的话，例如向下移动 30 行，可以使用 “30j” 或 “30↓” 的组合按键， 亦即加上想要进行的次数 (数字) 后，按下动作即可！ | |&lt;/p&gt;
&lt;h3 id=&#34;第二部分一般模式切换到编辑模式的可用的按钮说明&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#第二部分一般模式切换到编辑模式的可用的按钮说明&#34;&gt;#&lt;/a&gt; 第二部分：一般模式切换到编辑模式的可用的按钮说明&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;进入输入或取代的编辑模式&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;i, I&lt;/td&gt;
&lt;td&gt;进入输入模式 (Insert mode)：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;i 为『从目前光标所在处输入』， I 为『在目前所在行的第一个非空格符处开始输入』。 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;a, A&lt;/td&gt;
&lt;td&gt;进入输入模式 (Insert mode)：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;a 为『从目前光标所在的下一个字符处开始输入』， A 为『从光标所在行的最后一个字符处开始输入』。(常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;o, O&lt;/td&gt;
&lt;td&gt;进入输入模式 (Insert mode)：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;这是英文字母 o 的大小写。o 为在目前光标所在的下一行处输入新的一行； O 为在目前光标所在的上一行处输入新的一行！(常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;r, R&lt;/td&gt;
&lt;td&gt;进入取代模式 (Replace mode)：&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;r 只会取代光标所在的那一个字符一次；R 会一直取代光标所在的文字，直到按下 ESC 为止；(常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;上面这些按键中，在 vi 画面的左下角处会出现『–INSERT–』或『–REPLACE–』的字样。 由名称就知道该动作了吧！！特别注意的是，我们上面也提过了，你想要在档案里面输入字符时， 一定要在左下角处看到 INSERT 或 REPLACE 才能输入喔！&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;[Esc]&lt;/td&gt;
&lt;td&gt;退出编辑模式，回到一般模式中 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;第三部分一般模式切换到指令行模式的可用的按钮说明&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#第三部分一般模式切换到指令行模式的可用的按钮说明&#34;&gt;#&lt;/a&gt; 第三部分：一般模式切换到指令行模式的可用的按钮说明&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;指令行的储存、离开等指令&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;:w&lt;/td&gt;
&lt;td&gt;将编辑的数据写入硬盘档案中 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:w!&lt;/td&gt;
&lt;td&gt;若文件属性为『只读』时，强制写入该档案。不过，到底能不能写入， 还是跟你对该档案的档案权限有关啊！&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:q&lt;/td&gt;
&lt;td&gt;离开 vi (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:q!&lt;/td&gt;
&lt;td&gt;若曾修改过档案，又不想储存，使用！为强制离开不储存档案。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;注意一下啊，那个惊叹号 (!) 在 vi 当中，常常具有『强制』的意思～&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:wq&lt;/td&gt;
&lt;td&gt;储存后离开，若为 :wq! 则为强制储存后离开 (常用)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ZZ&lt;/td&gt;
&lt;td&gt;这是大写的 Z 喔！如果修改过，保存当前文件，然后退出！效果等同于 (保存并退出)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ZQ&lt;/td&gt;
&lt;td&gt;不保存，强制退出。效果等同于 :q!。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:w [filename]&lt;/td&gt;
&lt;td&gt;将编辑的数据储存成另一个档案（类似另存新档）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:r [filename]&lt;/td&gt;
&lt;td&gt;在编辑的数据中，读入另一个档案的数据。亦即将 『filename』 这个档案内容加到游标所在行后面&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:n1,n2 w [filename]&lt;/td&gt;
&lt;td&gt;将 n1 到 n2 的内容储存成 filename 这个档案。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:! command&lt;/td&gt;
&lt;td&gt;暂时离开 vi 到指令行模式下执行 command 的显示结果！例如&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;『:! ls /home』即可在 vi 当中察看 /home 底下以 ls 输出的档案信息！&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;vim 环境的变更&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:set nu&lt;/td&gt;
&lt;td&gt;显示行号，设定之后，会在每一行的前缀显示该行的行号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;:set nonu&lt;/td&gt;
&lt;td&gt;与 set nu 相反，为取消行号！&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;特别注意，在 vi/vim 中，数字是很有意义的！数字通常代表重复做几次的意思！ 也有可能是代表去到第几个什么什么的意思。&lt;/p&gt;
&lt;p&gt;举例来说，要删除 50 行，则是用 『50dd』 对吧！ 数字加在动作之前，如我要向下移动 20 行呢？那就是『20j』或者是『20↓』即可。&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/06/java/%E5%AF%B9PageHelper%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B0%81%E8%A3%85/</guid>
            <title>对PageHelper使用的封装</title>
            <link>http://example.com/2024/02/06/java/%E5%AF%B9PageHelper%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B0%81%E8%A3%85/</link>
            <category>PageHelper</category>
            <pubDate>Tue, 06 Feb 2024 09:27:01 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;1-问题点&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1-问题点&#34;&gt;#&lt;/a&gt; 1. 问题点&lt;/h2&gt;
&lt;p&gt;在使用 PageHelper 的过程中，产生了两个问题&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;一个分页接口点击下一页时，绝大多数的情况下数据总数是不变的，但却需要每次请求去查询统计数据总数，产生了性能浪费.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;实际使用中要实现分页要写两步，先在要执行分页的代码前标注 &lt;code&gt;PageHelper.startPage(vo);&lt;/code&gt; , 再在返回数据时使用 &lt;code&gt;PageInfo.of(list)&lt;/code&gt;  生成分页对象，步骤略微麻烦.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;2-代码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2-代码&#34;&gt;#&lt;/a&gt; 2. 代码&lt;/h2&gt;
&lt;p&gt;分页参数基础类&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; com.china315net.common.vo;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; io.swagger.annotations.ApiModelProperty;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; lombok.Data;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; com.china315net.common.constant.ConstantPool.MAX_PAGE_SIZE;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt; * 基本分页对象&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Data&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;BasePageVO&lt;/span&gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@ApiModelProperty(value = &amp;quot;当前页&amp;quot;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;Integer&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;pageNum&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@ApiModelProperty(value = &amp;quot;当页显示条数&amp;quot;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;Integer&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;pageSize&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt;  &lt;span class=&#34;hljs-number&#34;&gt;10&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@ApiModelProperty(value = &amp;quot;总页数&amp;quot;)&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-type&#34;&gt;Integer&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;totalRow&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;setPageSize&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(Integer pageSize)&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (pageSize &amp;gt; MAX_PAGE_SIZE) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.pageSize = MAX_PAGE_SIZE;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt;;&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.pageSize = pageSize;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;分页工具类&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; com.china315net.mybatis.util;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; com.china315net.common.vo.BasePageVO;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; com.github.pagehelper.ISelect;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; com.github.pagehelper.PageHelper;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; com.github.pagehelper.PageInfo;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.List;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.function.Function;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;PageUtil&lt;/span&gt; &amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;static&lt;/span&gt; &amp;lt;T, P &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;BasePageVO&lt;/span&gt;&amp;gt; PageInfo&amp;lt;T&amp;gt; &lt;span class=&#34;hljs-title function_&#34;&gt;doPage&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(P param, Function&amp;lt;P,List&amp;lt;T&amp;gt;&amp;gt; function)&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;ISelect&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; () -&amp;gt; function.apply(param);&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;total&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; param.getTotalRow();&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;pageNum&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; param.getPageNum();&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;pageSize&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; param.getPageSize();&lt;br&gt;        PageInfo&amp;lt;T&amp;gt; pageInfo;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;//最后一页强制触发分页条件&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (pageNum*pageSize &amp;gt;= total) &amp;#123;&lt;br&gt;            pageInfo = PageHelper.startPage(param).doSelectPageInfo(select);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            pageInfo = PageHelper.startPage(param).setCount(&lt;span class=&#34;hljs-literal&#34;&gt;false&lt;/span&gt;).doSelectPageInfo(select);&lt;br&gt;            &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;nowTotal&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; (pageNum-&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)*pageSize + pageInfo.getSize();&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;//当前页未满且不是最后一页,设置数据总数为当前数据总数&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (pageNum*pageSize &amp;gt; nowTotal) &amp;#123;&lt;br&gt;                total = nowTotal;&lt;br&gt;            &amp;#125;&lt;br&gt;            pageInfo.setTotal(total);&lt;br&gt;        &amp;#125;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; pageInfo;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;3-使用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3-使用&#34;&gt;#&lt;/a&gt; 3. 使用&lt;/h2&gt;
&lt;p&gt;使用的示例代码如下&lt;/p&gt;
&lt;figure class=&#34;highlight less&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs less&#34;&gt;&lt;span class=&#34;hljs-variable&#34;&gt;@ApiOperation&lt;/span&gt;(value = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;列表查询&amp;quot;&lt;/span&gt;)&lt;br&gt;&lt;span class=&#34;hljs-variable&#34;&gt;@GetMapping&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;/list&amp;quot;&lt;/span&gt;)&lt;br&gt;public ResultBean&amp;lt;PageInfo&amp;lt;BlendingFormulaVO&amp;gt;&amp;gt; &lt;span class=&#34;hljs-built_in&#34;&gt;list&lt;/span&gt;(BlendingFormulaSearchVO search) &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-selector-tag&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-selector-tag&#34;&gt;ResultBean&lt;/span&gt;&lt;span class=&#34;hljs-selector-class&#34;&gt;.success&lt;/span&gt;(PageUtil.&lt;span class=&#34;hljs-built_in&#34;&gt;doPage&lt;/span&gt;(search, &lt;span class=&#34;hljs-attribute&#34;&gt;blendingFormulaService&lt;/span&gt;::listPage));&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;4-工具类效果&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4-工具类效果&#34;&gt;#&lt;/a&gt; 4. 工具类效果&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;当前页为最后一页强制触发查询数据总数&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;当前页未满时说明数据库数据总数为当前分页计算出的数据总数，设置数据总数为当前当前分页计算出数据总数&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;不满足上面两条且前端传了分页总数的情况，不会去查询数据总数&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2024/02/06/%E5%B7%A5%E5%85%B7/git%E6%9A%82%E5%AD%98%E5%91%BD%E4%BB%A4/</guid>
            <title>git暂存命令</title>
            <link>http://example.com/2024/02/06/%E5%B7%A5%E5%85%B7/git%E6%9A%82%E5%AD%98%E5%91%BD%E4%BB%A4/</link>
            <category>git</category>
            <pubDate>Tue, 06 Feb 2024 08:40:01 +0000</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;暂存命令的作用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#暂存命令的作用&#34;&gt;#&lt;/a&gt; 暂存命令的作用&lt;/h4&gt;
&lt;p&gt;可以将 git 工作区的代码更改暂存，之后就可以执行 git pull、git merge 之类的命令&lt;/p&gt;
&lt;h4 id=&#34;暂存命令&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#暂存命令&#34;&gt;#&lt;/a&gt; 暂存命令&lt;/h4&gt;
&lt;figure class=&#34;highlight maxima&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs maxima&#34;&gt;git stash &lt;span class=&#34;hljs-built_in&#34;&gt;save&lt;/span&gt; &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;暂存的备注&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;直接执行 git stash 也可以达到暂存的目的，但是连续多次暂存后容易让人混淆哪次暂存了哪些代码&lt;/p&gt;
&lt;h4 id=&#34;查看暂存记录&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#查看暂存记录&#34;&gt;#&lt;/a&gt; 查看暂存记录&lt;/h4&gt;
&lt;figure class=&#34;highlight ebnf&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs ebnf&#34;&gt;&lt;span class=&#34;hljs-attribute&#34;&gt;git stash list&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;取回暂存代码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#取回暂存代码&#34;&gt;#&lt;/a&gt; 取回暂存代码&lt;/h4&gt;
&lt;figure class=&#34;highlight arcade&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs arcade&#34;&gt;git stash &lt;span class=&#34;hljs-built_in&#34;&gt;pop&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;取消【取消暂存代码】&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;git &lt;span class=&#34;hljs-keyword&#34;&gt;reset&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--hard&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;撤回提交&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#撤回提交&#34;&gt;#&lt;/a&gt; 撤回提交&lt;/h2&gt;
&lt;figure class=&#34;highlight pgsql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs pgsql&#34;&gt;git &lt;span class=&#34;hljs-keyword&#34;&gt;reset&lt;/span&gt; &lt;span class=&#34;hljs-comment&#34;&gt;--soft HEAD&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2023/04/30/maven%E9%A1%B9%E7%9B%AE%E8%A7%A3%E5%86%B3lombok%E4%B8%8Emanifold%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98/</guid>
            <title>maven项目解决lombok与manifold兼容问题</title>
            <link>http://example.com/2023/04/30/maven%E9%A1%B9%E7%9B%AE%E8%A7%A3%E5%86%B3lombok%E4%B8%8Emanifold%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98/</link>
            <category>maven</category>
            <category>lombok</category>
            <category>manifold</category>
            <pubDate>Sun, 30 Apr 2023 22:35:51 +0000</pubDate>
            <description><![CDATA[ &lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs xml&#34;&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;maven-compiler-plugin&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.8.1&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;source&lt;/span&gt;&amp;gt;&lt;/span&gt;17&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;source&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;target&lt;/span&gt;&amp;gt;&lt;/span&gt;17&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;target&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;encoding&lt;/span&gt;&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;encoding&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;compilerArgs&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-comment&#34;&gt;&amp;lt;!-- Configure manifold plugin--&amp;gt;&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;arg&lt;/span&gt;&amp;gt;&lt;/span&gt;-Xplugin:Manifold&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;arg&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;compilerArgs&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;&amp;lt;!-- Add the processor path for the plugin --&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;annotationProcessorPaths&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;path&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;systems.manifold&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;manifold-ext&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2023.1.3&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;path&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;path&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.projectlombok&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;lombok&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.18.24&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;path&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;path&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.projectlombok&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;lombok-mapstruct-binding&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;                &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;0.2.0&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;            &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;path&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;annotationProcessorPaths&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-tag&#34;&gt;&amp;lt;/&lt;span class=&#34;hljs-name&#34;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2023/04/30/docker%E9%83%A8%E7%BD%B2gitlab%E7%A7%81%E6%9C%8D/</guid>
            <title>docker部署gitlab私服</title>
            <link>http://example.com/2023/04/30/docker%E9%83%A8%E7%BD%B2gitlab%E7%A7%81%E6%9C%8D/</link>
            <category>docker</category>
            <category>gitlab</category>
            <pubDate>Sun, 30 Apr 2023 00:13:01 +0000</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;前置条件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#前置条件&#34;&gt;#&lt;/a&gt; 前置条件&lt;/h4&gt;
&lt;p&gt;安装 docker, 配置国内镜像源&lt;/p&gt;
&lt;h4 id=&#34;部署命令使用了一个汉化的版本&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#部署命令使用了一个汉化的版本&#34;&gt;#&lt;/a&gt; 部署命令（使用了一个汉化的版本）&lt;/h4&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;docker run -d -p &lt;span class=&#34;hljs-number&#34;&gt;443&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;443&lt;/span&gt; -p &lt;span class=&#34;hljs-number&#34;&gt;80&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;80&lt;/span&gt; -p &lt;span class=&#34;hljs-number&#34;&gt;222&lt;/span&gt;:&lt;span class=&#34;hljs-number&#34;&gt;22&lt;/span&gt; --name gitlab --restart always -v &lt;span class=&#34;hljs-regexp&#34;&gt;/home/gi&lt;/span&gt;tlab&lt;span class=&#34;hljs-regexp&#34;&gt;/config:/&lt;/span&gt;etc&lt;span class=&#34;hljs-regexp&#34;&gt;/gitlab -v /&lt;/span&gt;home&lt;span class=&#34;hljs-regexp&#34;&gt;/gitlab/&lt;/span&gt;logs:&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;log&lt;span class=&#34;hljs-regexp&#34;&gt;/gitlab -v /&lt;/span&gt;home&lt;span class=&#34;hljs-regexp&#34;&gt;/gitlab/&lt;/span&gt;data:&lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;opt&lt;span class=&#34;hljs-regexp&#34;&gt;/gitlab docker.io/&lt;/span&gt;twang2218/gitlab-ce-zh&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;把你服务器的端口映射到容器内部的 443 或者 80&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;-v &lt;span class=&#34;hljs-regexp&#34;&gt;/home/gi&lt;/span&gt;tlab&lt;span class=&#34;hljs-regexp&#34;&gt;/config:/&lt;/span&gt;etc/gitlab  &lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这里把容器的配置文件夹映射到服务器真实目录 /home/gitlab/config&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;-v &lt;span class=&#34;hljs-regexp&#34;&gt;/home/gi&lt;/span&gt;tlab&lt;span class=&#34;hljs-regexp&#34;&gt;/logs:/&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/log/gi&lt;/span&gt;tlab&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这里把容器的日志文件夹映射到服务器真实目录 /home/gitlab/logs&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;-v &lt;span class=&#34;hljs-regexp&#34;&gt;/home/gi&lt;/span&gt;tlab&lt;span class=&#34;hljs-regexp&#34;&gt;/data:/&lt;/span&gt;var&lt;span class=&#34;hljs-regexp&#34;&gt;/opt/gi&lt;/span&gt;tlab&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这里把容器的存储文件夹映射到服务器真实目录 /home/gitlab/data&lt;/p&gt;
&lt;h4 id=&#34;进入容器配置gitlab&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#进入容器配置gitlab&#34;&gt;#&lt;/a&gt; 进入容器配置 gitlab&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;1. 进入容器&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;docker exec -it gitlab &lt;span class=&#34;hljs-regexp&#34;&gt;/bin/&lt;/span&gt;bash&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;2. 修改配置文件&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;vim &lt;span class=&#34;hljs-regexp&#34;&gt;/etc/gi&lt;/span&gt;tlab/gitlab.rb&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;3. 配置&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight livescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs livescript&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#外部访问地址&lt;/span&gt;&lt;br&gt; external_url &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;http://124.225.116.118:35236&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#gitlab时区&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;time_zone&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;UTC&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#gitlab邮件通知&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;gitlab_email_enabled&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;gitlab_email_from&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;2513178346@qq.com&amp;#x27;&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_enable&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_address&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;smtp.qq.com&amp;quot;&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_port&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-number&#34;&gt;465&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_user_name&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;2513178346@qq.com&amp;quot;&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_password&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;你的&amp;quot;&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_domain&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;qq.com&amp;quot;&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_authentication&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;login&amp;quot;&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_enable_starttls_auto&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_tls&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;smtp_pool&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#可选，配置ip限流、白名单&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;rack_attack_git_basic_auth&amp;#x27;&lt;/span&gt;] = &amp;#123;&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;enabled&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;,&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ip_whitelist&amp;#x27;&lt;/span&gt; =&amp;gt; [&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;127.0.0.1&amp;quot;&lt;/span&gt;],&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;maxretry&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;,&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;findtime&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;60&lt;/span&gt;,&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;bantime&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;3600&lt;/span&gt;&lt;br&gt; &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;重启服务&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#重启服务&#34;&gt;#&lt;/a&gt; 重启服务&lt;/h4&gt;
&lt;figure class=&#34;highlight crmsh&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs crmsh&#34;&gt;gitlab-ctl &lt;span class=&#34;hljs-literal&#34;&gt;stop&lt;/span&gt;&lt;br&gt;gitlab-ctl reconfigure&lt;br&gt;gitlab-ctl &lt;span class=&#34;hljs-literal&#34;&gt;start&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;一些常见问题&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#一些常见问题&#34;&gt;#&lt;/a&gt; 一些常见问题&lt;/h4&gt;
&lt;p&gt;1. 同一个 ip 短时间并发可能会触发限流&lt;/p&gt;
&lt;p&gt;解决办法&lt;/p&gt;
&lt;p&gt;方法一、暂时解决，进入容器执行命令删除 IP 黑名单&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;redis-cli -s &lt;span class=&#34;hljs-regexp&#34;&gt;/var/&lt;/span&gt;opt&lt;span class=&#34;hljs-regexp&#34;&gt;/gitlab/&lt;/span&gt;redis/redis.socket&lt;br&gt;keys *attack*&lt;br&gt;del &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;上一步查到的键值&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;方法二、加 IP 白名单（如果有固定 ip 可以这么做）或增加并发阈值&lt;/p&gt;
&lt;figure class=&#34;highlight livescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs livescript&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;#可选，配置ip限流、白名单&lt;/span&gt;&lt;br&gt; gitlab_rails[&lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;rack_attack_git_basic_auth&amp;#x27;&lt;/span&gt;] = &amp;#123;&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;enabled&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;,&lt;br&gt;   &lt;span class=&#34;hljs-comment&#34;&gt;#ip白名单&lt;/span&gt;&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;ip_whitelist&amp;#x27;&lt;/span&gt; =&amp;gt; [&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;127.0.0.1&amp;quot;&lt;/span&gt;],&lt;br&gt;   &lt;span class=&#34;hljs-comment&#34;&gt;#并发阈值&lt;/span&gt;&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;maxretry&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;100&lt;/span&gt;,&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;findtime&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;60&lt;/span&gt;,&lt;br&gt;   &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;bantime&amp;#x27;&lt;/span&gt; =&amp;gt; &lt;span class=&#34;hljs-number&#34;&gt;3600&lt;/span&gt;&lt;br&gt; &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2023/04/30/nginx%E6%90%AD%E5%BB%BA%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/</guid>
            <title>nginx搭建文件服务器</title>
            <link>http://example.com/2023/04/30/nginx%E6%90%AD%E5%BB%BA%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/</link>
            <category>nginx</category>
            <pubDate>Sun, 30 Apr 2023 00:09:41 +0000</pubDate>
            <description><![CDATA[ &lt;p&gt;nginx 配置&lt;/p&gt;
&lt;figure class=&#34;highlight nginx&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs nginx&#34;&gt;&lt;span class=&#34;hljs-section&#34;&gt;server&lt;/span&gt; &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-attribute&#34;&gt;listen&lt;/span&gt; &lt;span class=&#34;hljs-number&#34;&gt;443&lt;/span&gt;;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;# 对应的域名，多个以空格分开&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-attribute&#34;&gt;server_name&lt;/span&gt;  cdn.xxx.com;&lt;br&gt;        &lt;span class=&#34;hljs-attribute&#34;&gt;charset&lt;/span&gt; utf-&lt;span class=&#34;hljs-number&#34;&gt;8&lt;/span&gt;;&lt;br&gt;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;# 证书文件地址&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;#ssl_certificate      /data/ssl/cdn.xxx.com_bundle.crt;&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-attribute&#34;&gt;ssl_certificate&lt;/span&gt;      /data/ssl/cdn.xxx.com.pem;&lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;# 证书key&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-attribute&#34;&gt;ssl_certificate_key&lt;/span&gt;   /data/ssl/cdn.xxx.com.key;&lt;br&gt;        &lt;br&gt;        &lt;span class=&#34;hljs-comment&#34;&gt;#监听/file的路由地址映射到磁盘&lt;/span&gt;&lt;br&gt;        &lt;span class=&#34;hljs-section&#34;&gt;location&lt;/span&gt; /file &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-attribute&#34;&gt;add_header&lt;/span&gt; Access-Control-Allow-Origin *;&lt;br&gt;                &lt;span class=&#34;hljs-attribute&#34;&gt;add_header&lt;/span&gt; Access-Control-Allow-Credentials &lt;span class=&#34;hljs-literal&#34;&gt;true&lt;/span&gt;;&lt;br&gt;                &lt;span class=&#34;hljs-attribute&#34;&gt;add_header&lt;/span&gt; Access-Control-Allow-Methods GET,POST,OPTIONS;&lt;br&gt;                &lt;span class=&#34;hljs-attribute&#34;&gt;add_header&lt;/span&gt; Access-Control-Allow-Headers DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type;&lt;br&gt;                &lt;span class=&#34;hljs-attribute&#34;&gt;alias&lt;/span&gt; /data/file;&lt;br&gt;                &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2023/02/06/%E5%B7%A5%E5%85%B7/git%E6%9B%B4%E6%96%B0.gitignore%E6%96%87%E4%BB%B6%E5%90%8E%E4%B8%8D%E7%94%9F%E6%95%88/</guid>
            <title>git更新.gitignore文件后不生效</title>
            <link>http://example.com/2023/02/06/%E5%B7%A5%E5%85%B7/git%E6%9B%B4%E6%96%B0.gitignore%E6%96%87%E4%BB%B6%E5%90%8E%E4%B8%8D%E7%94%9F%E6%95%88/</link>
            <category>git</category>
            <pubDate>Mon, 06 Feb 2023 00:13:01 +0000</pubDate>
            <description><![CDATA[ &lt;p&gt;项目更新了.gitignore 文件后直接提交不会生效，解决如下&lt;/p&gt;
&lt;figure class=&#34;highlight awk&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs awk&#34;&gt;git rm -r --cached . &lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt; 删除本地缓存&lt;br&gt;git add . &lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt; 添加要提交的文件&lt;br&gt;git commit -m &lt;span class=&#34;hljs-string&#34;&gt;&amp;#x27;update .gitignore&amp;#x27;&lt;/span&gt; &lt;span class=&#34;hljs-regexp&#34;&gt;//&lt;/span&gt; 更新本地的缓存&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/2023/01/09/java/MyBatis%E4%B9%8BTypeHandler%E7%94%A8%E6%B3%95/</guid>
            <title>MyBatis之TypeHandler用法</title>
            <link>http://example.com/2023/01/09/java/MyBatis%E4%B9%8BTypeHandler%E7%94%A8%E6%B3%95/</link>
            <category>java</category>
            <category>mybatis</category>
            <category>TypeHandler</category>
            <pubDate>Mon, 09 Jan 2023 08:16:03 +0000</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;一-问题点&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#一-问题点&#34;&gt;#&lt;/a&gt; 一。问题点&lt;/h2&gt;
&lt;h2 id=&#34;在使用postgresql的过程中有用到数组类型与json类型这些类型直接用java的类型去接收是会出现类型转换异常的怎么处理呢这时候就要用到typehandler了&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#在使用postgresql的过程中有用到数组类型与json类型这些类型直接用java的类型去接收是会出现类型转换异常的怎么处理呢这时候就要用到typehandler了&#34;&gt;#&lt;/a&gt; 在使用 PostgreSQL 的过程中有用到数组类型与 json 类型，这些类型直接用 java 的类型去接收是会出现类型转换异常的，&lt;br&gt;
 怎么处理呢，这时候就要用到 TypeHandler 了&lt;/h2&gt;
&lt;h2 id=&#34;二-代码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#二-代码&#34;&gt;#&lt;/a&gt; 二。代码&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;java 数组类型接收 jdbc array&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; com.china315net.mybatis.handler;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; lombok.extern.slf4j.Slf4j;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.JdbcType;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.MappedJdbcTypes;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.MappedTypes;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.TypeException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.stereotype.Component;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.Array;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.PreparedStatement;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.SQLException;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt; * 数组类型处理程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Slf4j&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@MappedJdbcTypes(&amp;#123;JdbcType.ARRAY&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@MappedTypes(&amp;#123;String[].class, Short[].class, Integer[].class, Long[].class&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Component&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;ArrayTypeHandler&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;org&lt;/span&gt;.apache.ibatis.type.ArrayTypeHandler &amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;setNonNullParameter&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(PreparedStatement ps, &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; i, Object parameter, JdbcType jdbcType)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        log.debug(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;jdbcType:&amp;#123;&amp;#125;&amp;quot;&lt;/span&gt;, jdbcType);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (parameter &lt;span class=&#34;hljs-keyword&#34;&gt;instanceof&lt;/span&gt; Array array) &amp;#123;&lt;br&gt;            ps.setArray(i, array);&lt;br&gt;        &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!parameter.getClass().isArray()) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-keyword&#34;&gt;throw&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;TypeException&lt;/span&gt;(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;ArrayType Handler requires SQL array or java array parameter and does not support type &amp;quot;&lt;/span&gt; + parameter.getClass());&lt;br&gt;            &amp;#125;&lt;br&gt;            Class&amp;lt;?&amp;gt; componentType = parameter.getClass().getComponentType();&lt;br&gt;            &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;arrayTypeName&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.resolveTypeName(componentType);&lt;br&gt;            &lt;span class=&#34;hljs-type&#34;&gt;Array&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;array&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; ps.getConnection().createArrayOf(arrayTypeName, (Object[]) parameter);&lt;br&gt;            ps.setArray(i, array);&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;java List 类型接收 jdbc array&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; com.china315net.mybatis.handler;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; lombok.extern.slf4j.Slf4j;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.JdbcType;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.MappedJdbcTypes;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.MappedTypes;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.stereotype.Component;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.Array;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.CallableStatement;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.PreparedStatement;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.ResultSet;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.SQLException;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.Arrays;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.util.List;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt; * 数组类型处理程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Slf4j&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@MappedJdbcTypes(&amp;#123;JdbcType.ARRAY&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@MappedTypes(&amp;#123;List.class&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Component&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;ListToArrayTypeHandler&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;org&lt;/span&gt;.apache.ibatis.type.ArrayTypeHandler &amp;#123;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;setNonNullParameter&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(PreparedStatement ps, &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; i, Object parameter, JdbcType jdbcType)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (parameter &lt;span class=&#34;hljs-keyword&#34;&gt;instanceof&lt;/span&gt; List&amp;lt;?&amp;gt; list) &amp;#123;&lt;br&gt;            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!list.isEmpty()) &amp;#123;&lt;br&gt;                &lt;span class=&#34;hljs-type&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;arrayTypeName&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.resolveTypeName(list.get(&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;).getClass());&lt;br&gt;                &lt;span class=&#34;hljs-type&#34;&gt;Array&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;array&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; ps.getConnection().createArrayOf(arrayTypeName, list.toArray(Object[]::&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt;));&lt;br&gt;                ps.setArray(i, array);&lt;br&gt;            &amp;#125;&lt;br&gt;        &amp;#125;&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;hljs-title function_&#34;&gt;getNullableResult&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(ResultSet rs, String columnName)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        log.debug(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;getNullableResult1&amp;quot;&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.extractList(rs.getArray(columnName));&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;hljs-title function_&#34;&gt;getNullableResult&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(ResultSet rs, &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; columnIndex)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        log.debug(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;getNullableResult2&amp;quot;&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.extractList(rs.getArray(columnIndex));&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;hljs-title function_&#34;&gt;getNullableResult&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(CallableStatement cs, &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; columnIndex)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        log.debug(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;getNullableResult3&amp;quot;&lt;/span&gt;);&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;hljs-built_in&#34;&gt;this&lt;/span&gt;.extractList(cs.getArray(columnIndex));&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; Object &lt;span class=&#34;hljs-title function_&#34;&gt;extractList&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(Array array)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; Arrays.stream(((Object[]) extractArray(array))).toList();&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;java 使用 FastJson2 的 JSONObject,JSONArray 类型接收 pgsql 的 json 或 jsonb&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;package&lt;/span&gt; com.china315net.mybatis.handler;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; com.alibaba.fastjson2.JSON;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; com.alibaba.fastjson2.JSONArray;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; com.alibaba.fastjson2.JSONObject;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.BaseTypeHandler;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.JdbcType;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.apache.ibatis.type.MappedTypes;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.postgresql.util.PGobject;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; org.springframework.stereotype.Component;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.CallableStatement;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.PreparedStatement;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.ResultSet;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;import&lt;/span&gt; java.sql.SQLException;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt; * json类型处理程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-comment&#34;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@MappedTypes(&amp;#123;JSONObject.class, JSONArray.class&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Component&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;JsonbTypeHandler&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;BaseTypeHandler&lt;/span&gt;&amp;lt;Object&amp;gt; &amp;#123;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;setNonNullParameter&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(PreparedStatement ps, &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; i, Object parameter, JdbcType jdbcType)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-type&#34;&gt;PGobject&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;jsonObject&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;PGobject&lt;/span&gt;();&lt;br&gt;        jsonObject.setType(&lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;json&amp;quot;&lt;/span&gt;);&lt;br&gt;        jsonObject.setValue(JSON.toJSONString(parameter));&lt;br&gt;        ps.setObject(i, jsonObject);&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;hljs-title function_&#34;&gt;getNullableResult&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(ResultSet rs, String columnName)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; JSON.parse(rs.getString(columnName));&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;hljs-title function_&#34;&gt;getNullableResult&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(ResultSet rs, &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; columnIndex)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; JSON.parse(rs.getString(columnIndex));&lt;br&gt;    &amp;#125;&lt;br&gt;&lt;br&gt;    &lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt;&lt;br&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;hljs-title function_&#34;&gt;getNullableResult&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(CallableStatement cs, &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; columnIndex)&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;&lt;br&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; JSON.parse(cs.getString(columnIndex));&lt;br&gt;    &amp;#125;&lt;br&gt;&amp;#125;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;h2 id=&#34;注意点&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#注意点&#34;&gt;#&lt;/a&gt; 注意点:&lt;/h2&gt;
&lt;h3 id=&#34;typehandler接口方法说明&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#typehandler接口方法说明&#34;&gt;#&lt;/a&gt; TypeHandler 接口方法说明&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;setNonNullParameter 方法在写入的数据库操作时会调用&lt;/li&gt;
&lt;li&gt;getNullableResult 方法在查询的数据库操作时会调用&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;类型处理器支持的java与jdbc类型&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#类型处理器支持的java与jdbc类型&#34;&gt;#&lt;/a&gt; 类型处理器支持的 Java 与 jdbc 类型&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&#34;如果要决定一个类型处理器支持哪些java类型有如下途径优先级从上到下依次增加&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#如果要决定一个类型处理器支持哪些java类型有如下途径优先级从上到下依次增加&#34;&gt;#&lt;/a&gt; 如果要决定一个类型处理器支持哪些&lt;strong&gt; Java&lt;/strong&gt; 类型，有如下途径 (优先级从上到下依次增加)。&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;类型处理器的泛型可以决定类型处理器支持的&lt;strong&gt; JavaType&lt;/strong&gt;；&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;在类型处理器上使用注解 @&lt;strong&gt;MappedTypes&lt;/strong&gt; 来指定，例如 @&lt;strong&gt;MappedTypes({List.class})&lt;/strong&gt;；&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;在配置文件中注册类型处理器时，通过 &amp;lt;&lt;strong&gt;typeHandler&lt;/strong&gt; &amp;gt; 标签的&lt;strong&gt; javaType&lt;/strong&gt; 属性来指定，例如 &lt;code&gt;&amp;lt;typeHandler handler=&amp;quot;com.lee.learn.mybatis.typehandler.ListStringTypeHandler&amp;quot; javaType=&amp;quot;List&amp;quot;/&amp;gt;&lt;/code&gt; 。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;h4 id=&#34;如果要决定一个类型处理器支持哪些jdbc类型有如下途径优先级从上到下依次增加&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#如果要决定一个类型处理器支持哪些jdbc类型有如下途径优先级从上到下依次增加&#34;&gt;#&lt;/a&gt; 如果要决定一个类型处理器支持哪些&lt;strong&gt; Jdbc&lt;/strong&gt; 类型，有如下途径 (优先级从上到下依次增加)。&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;在类型处理器上使用注解 @&lt;strong&gt;MappedJdbcTypes&lt;/strong&gt; 来指定，例如 @&lt;strong&gt;MappedJdbcTypes({JdbcType.VARCHAR, JdbcType.CHAR})&lt;/strong&gt;；&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;在配置文件中注册类型处理器时，通过 &amp;lt;&lt;strong&gt;typeHandler&lt;/strong&gt; &amp;gt; 标签的&lt;strong&gt; jdbcType&lt;/strong&gt; 属性来指定（注意：同时也需要设置了&lt;strong&gt; javaType&lt;/strong&gt;&lt;br&gt;
 属性，否则&lt;strong&gt; jdbcType&lt;/strong&gt; 属性不生效）， 例如 &amp;lt;&lt;strong&gt;typeHandler handler=&amp;quot;&lt;br&gt;
com.lee.learn.mybatis.typehandler.ListStringTypeHandler&amp;quot; javaType=“List” jdbcType=“VARCHAR”/&lt;/strong&gt;&amp;gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;typehandler如何生效&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#typehandler如何生效&#34;&gt;#&lt;/a&gt; TypeHandler 如何生效&lt;/h3&gt;
&lt;p&gt;通常，&lt;strong&gt;TypeHandler&lt;/strong&gt; 的使用场景有两个。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在设置预处理语句（&lt;strong&gt;PreparedStatement&lt;/strong&gt;）中的参数时，完成&lt;strong&gt; Java&lt;/strong&gt; 类型到&lt;strong&gt; Jdbc&lt;/strong&gt; 类型的转换，通常就是&lt;strong&gt; INSERT&lt;/strong&gt; 和&lt;strong&gt; UPDATE&lt;/strong&gt;&lt;br&gt;
 的场景；&lt;/li&gt;
&lt;li&gt;在将查询到的结果记录映射到&lt;strong&gt; Java&lt;/strong&gt; 实体对象时，完成&lt;strong&gt; Jdbc&lt;/strong&gt; 类型到&lt;strong&gt; Java&lt;/strong&gt; 类型的转换，通常就是会使用到 &amp;lt;&lt;strong&gt;resultMap&lt;/strong&gt;&lt;br&gt;
 &amp;gt; 的场景。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;在使用场景下，如何让我们自定义的&lt;strong&gt; TypeHandler&lt;/strong&gt; 生效，如下直接给出结论，再做验证。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;显式使用&lt;/strong&gt;。示例中就是显示使用，即在 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 标签中和 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  占位符中使用&lt;strong&gt; typeHandler&lt;/strong&gt;&lt;br&gt;
 属性来指定使用的类型处理器，这种方式是最简单粗暴的，就算不在配置文件中注册类型处理器，就算没有为类型处理器配置任何支持的&lt;br&gt;
&lt;strong&gt; Jdbc&lt;/strong&gt; 类型，只要在 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 标签中和 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  占位符中使用了&lt;strong&gt; typeHandler&lt;/strong&gt; 属性来指定要使用的类型处理器，那么 **MyBatis&lt;br&gt;
** 就会使用这个类型处理器；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;隐式使用&lt;/strong&gt;。通常，我们是不会关注到&lt;strong&gt; TypeHandler&lt;/strong&gt; 的，然而大部分时候&lt;strong&gt; Java&lt;/strong&gt; 类型到&lt;strong&gt; Jdbc&lt;/strong&gt; 类型的相互转换都能成功完成，是因为&lt;br&gt;
&lt;strong&gt; MyBatis&lt;/strong&gt; 会隐式使用其内置的&lt;strong&gt; TypeHandler&lt;/strong&gt;，而隐式使用哪个内置&lt;strong&gt; TypeHandler&lt;/strong&gt;，是通过 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 标签和 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  占位符的&lt;br&gt;
&lt;strong&gt; JavaType&lt;/strong&gt; 和&lt;strong&gt; JdbcType&lt;/strong&gt; 进行推断的。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;显式使用&lt;/strong&gt;没什么好说的，最为简单明了。下面重点说一下&lt;strong&gt;隐式使用&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;首先能够被隐式使用的&lt;strong&gt; TypeHandler&lt;/strong&gt;，都需要完成注册，自定义的&lt;strong&gt; TypeHandler&lt;/strong&gt; 可以在配置文件中通过 &amp;lt;&lt;strong&gt;typeHandler&lt;/strong&gt;&lt;br&gt;
 &amp;gt; 标签注册，而内置的&lt;strong&gt; TypeHandler&lt;/strong&gt; 是在&lt;strong&gt; TypeHandlerRegistry#TypeHandlerRegistry&lt;/strong&gt; 方法完成的注册，这个方法有点长，这里不再展示。&lt;/p&gt;
&lt;p&gt;然后每一个&lt;strong&gt; TypeHandler&lt;/strong&gt; 都有其支持的&lt;strong&gt; Java&lt;/strong&gt; 类型，以及可能支持的&lt;strong&gt; Jdbc&lt;/strong&gt; 类型（也可能没有），&lt;strong&gt;TypeHandler&lt;/strong&gt; 注册到 **MyBatis&lt;br&gt;
** 中后，是按照如下形式存储的。&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;Map&amp;lt;JavaType, Map&amp;lt;JdbcType, TypeHandler&amp;gt;&amp;gt;&lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;final&lt;/span&gt; Map&amp;lt;Type, Map&amp;lt;JdbcType, TypeHandler&amp;lt;?&amp;gt;&amp;gt;&amp;gt;typeHandlerMap=&lt;span class=&#34;hljs-keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;hljs-title class_&#34;&gt;ConcurrentHashMap&lt;/span&gt;&amp;lt;&amp;gt;();&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对隐式使用&lt;strong&gt; TypeHandler&lt;/strong&gt; 做一个小结。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;每一个&lt;strong&gt; TypeHandler&lt;/strong&gt; 都有其支持的&lt;strong&gt; Java&lt;/strong&gt; 类型，以及可能支持的&lt;strong&gt; Jdbc&lt;/strong&gt; 类型（也可能没有），并且在&lt;strong&gt; MyBatis&lt;/strong&gt; 中以 *&lt;br&gt;
&lt;em&gt;Map&amp;lt;JavaType, Map&amp;lt;JdbcType, TypeHandler&amp;gt;&amp;gt;&lt;/em&gt;* 的形式存放；&lt;/li&gt;
&lt;li&gt;如果有多个&lt;strong&gt; TypeHandler&lt;/strong&gt; 的支持的&lt;strong&gt; Java&lt;/strong&gt; 类型和&lt;strong&gt; Jdbc&lt;/strong&gt; 类型都一样，则后注册的&lt;strong&gt; TypeHandler&lt;/strong&gt; 会覆盖先注册的 *&lt;br&gt;
&lt;em&gt;TypeHandler&lt;/em&gt;*；&lt;/li&gt;
&lt;li&gt;如果在&lt;strong&gt; MyBatis&lt;/strong&gt; 的参数占位符 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  或者结果映射标签 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 中通过&lt;strong&gt; javaType&lt;/strong&gt; 属性指定了&lt;strong&gt; JavaType&lt;/strong&gt;，则&lt;strong&gt; MyBatis&lt;/strong&gt;&lt;br&gt;
 在推断使用哪种&lt;strong&gt; TypeHandler&lt;/strong&gt; 时依据的&lt;strong&gt; JavaType&lt;/strong&gt; 会使用&lt;strong&gt; javaType&lt;/strong&gt; 属性的值，否则，如果是 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 的话则&lt;strong&gt; MyBatis&lt;/strong&gt;&lt;br&gt;
 能根据映射对象推断出&lt;strong&gt; JavaType&lt;/strong&gt;，如果是 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  的话则&lt;strong&gt; JavaType&lt;/strong&gt; 为&lt;strong&gt; Object&lt;/strong&gt;；&lt;/li&gt;
&lt;li&gt;如果在&lt;strong&gt; MyBatis&lt;/strong&gt; 的参数占位符 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  或者结果映射标签 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 中通过&lt;strong&gt; jdbcType&lt;/strong&gt; 属性指定了&lt;strong&gt; JdbcType&lt;/strong&gt;，则&lt;strong&gt; MyBatis&lt;/strong&gt;&lt;br&gt;
 在推断使用哪种&lt;strong&gt; TypeHandler&lt;/strong&gt; 时依据的&lt;strong&gt; JdbcType&lt;/strong&gt; 会使用&lt;strong&gt; jdbcType&lt;/strong&gt; 属性的值，否则依据的&lt;strong&gt; JdbcType&lt;/strong&gt; 会为&lt;strong&gt; null&lt;/strong&gt;；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MyBatis&lt;/strong&gt; 在推断使用哪个&lt;strong&gt; TypeHandler&lt;/strong&gt; 时，会先使用&lt;strong&gt; JavaType&lt;/strong&gt; 拿到&lt;strong&gt; JavaType&lt;/strong&gt; 对应的&lt;strong&gt; Map&amp;lt;JdbcType,&lt;br&gt;
TypeHandler&amp;gt;&lt;/strong&gt;，然后使用&lt;strong&gt; JdbcType&lt;/strong&gt; 去匹配&lt;strong&gt; TypeHandler&lt;/strong&gt;，匹配不到则再使用&lt;strong&gt; JdbcType=null&lt;/strong&gt; 去匹配&lt;strong&gt; TypeHandler&lt;/strong&gt;&lt;br&gt;
，如果还匹配不到，则判断&lt;strong&gt; JavaType&lt;/strong&gt; 对应的&lt;strong&gt; TypeHandler&lt;/strong&gt; 是否有多个，如果是多个则返回&lt;strong&gt; null&lt;/strong&gt; 表示匹配失败，如果只有一个则使用这个&lt;br&gt;
&lt;strong&gt; TypeHandler&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;spring 框架可以把 TypeHandler 实例注册到 IOC 容器，在使用时会根据类型去推断出要用哪个类型处理器&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;最后建议自定义的typehandler都要为其指定支持的javatype和jdbctype以及必要时在result标签和占位符中都把javatype和jdbctype属性配置上这样mybatis能够快速无误的帮我们推断出应该使用哪个类型处理器&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#最后建议自定义的typehandler都要为其指定支持的javatype和jdbctype以及必要时在result标签和占位符中都把javatype和jdbctype属性配置上这样mybatis能够快速无误的帮我们推断出应该使用哪个类型处理器&#34;&gt;#&lt;/a&gt; 最后建议自定义的&lt;strong&gt; TypeHandler&lt;/strong&gt; 都要为其指定支持的&lt;strong&gt; JavaType&lt;/strong&gt; 和&lt;strong&gt; JdbcType&lt;/strong&gt;，以及必要时在 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 标签和 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  占位符中都把&lt;br&gt;
&lt;strong&gt; javaType&lt;/strong&gt; 和&lt;strong&gt; jdbcType&lt;/strong&gt; 属性配置上，这样&lt;strong&gt; MyBatis&lt;/strong&gt; 能够快速无误的帮我们推断出应该使用哪个类型处理器。&lt;/h2&gt;
&lt;h3 id=&#34;小补充&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#小补充&#34;&gt;#&lt;/a&gt; 小补充&lt;/h3&gt;
&lt;p&gt;这里再对为参数占位符 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  推断类型处理器时的一些逻辑进行补充说明，不看也不影响对本篇文章的理解。&lt;/p&gt;
&lt;p&gt;为参数占位符 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  推断类型处理器时，如果没有通过&lt;strong&gt; javaType&lt;/strong&gt; 来指定&lt;strong&gt; Java&lt;/strong&gt; 类型，那么&lt;strong&gt; MyBatis&lt;/strong&gt; 是无法知道&lt;strong&gt; Java&lt;/strong&gt;&lt;br&gt;
 类型是什么的（而 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 标签是可以的，这是不同点），此时&lt;strong&gt; MyBatis&lt;/strong&gt; 会默认&lt;strong&gt; Java&lt;/strong&gt; 类型是&lt;strong&gt; Object&lt;/strong&gt;，然后通过&lt;strong&gt; Object&lt;/strong&gt; 这个&lt;br&gt;
&lt;strong&gt; JavaType&lt;/strong&gt; 拿到一个&lt;strong&gt; UnknownTypeHandler&lt;/strong&gt; 内置类型处理器，下面看一下&lt;strong&gt; UnknownTypeHandler&lt;/strong&gt; 的&lt;strong&gt; setNonNullParameter ()&lt;/strong&gt; 方法。&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;code class=&#34;hljs java&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;@Override&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;hljs-title function_&#34;&gt;setNonNullParameter&lt;/span&gt;&lt;span class=&#34;hljs-params&#34;&gt;(PreparedStatement ps, &lt;span class=&#34;hljs-type&#34;&gt;int&lt;/span&gt; i, Object parameter, JdbcType jdbcType)&lt;/span&gt;         &lt;span class=&#34;hljs-keyword&#34;&gt;throws&lt;/span&gt; SQLException &amp;#123;     &lt;span class=&#34;hljs-type&#34;&gt;TypeHandler&lt;/span&gt; &lt;span class=&#34;hljs-variable&#34;&gt;handler&lt;/span&gt; &lt;span class=&#34;hljs-operator&#34;&gt;=&lt;/span&gt; resolveTypeHandler(parameter, jdbcType);     handler.setParameter(ps, i, parameter, jdbcType); &amp;#125;  &lt;span class=&#34;hljs-keyword&#34;&gt;private&lt;/span&gt; TypeHandler&amp;lt;?&amp;gt; resolveTypeHandler(Object parameter, JdbcType jdbcType) &amp;#123;     TypeHandler&amp;lt;?&amp;gt; handler;     &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (parameter == &lt;span class=&#34;hljs-literal&#34;&gt;null&lt;/span&gt;) &amp;#123;         handler = OBJECT_TYPE_HANDLER;     &amp;#125; &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt; &amp;#123;         &lt;span class=&#34;hljs-comment&#34;&gt;// 根据需要设置到PreparedStatement中的参数判断出Java类型         // 然后再调用到TypeHandlerRegistry#getTypeHandler拿TypeHandler         handler = typeHandlerRegistrySupplier.get().getTypeHandler(parameter.getClass(), jdbcType);         if (handler == null || handler instanceof UnknownTypeHandler) &amp;#123;             handler = OBJECT_TYPE_HANDLER;         &amp;#125;     &amp;#125;     return handler; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;已知&lt;strong&gt; setNonNullParameter ()&lt;/strong&gt; 方法是会在实际执行&lt;strong&gt; SQL&lt;/strong&gt; 语句前被调用到，此时会完成&lt;strong&gt; PreparedStatement&lt;/strong&gt; 的参数设置，因此这时能够拿到实际设置到&lt;br&gt;
&lt;strong&gt; PreparedStatement&lt;/strong&gt; 中的参数值从而得到参数的&lt;strong&gt; JavaType&lt;/strong&gt;，所以这时会再尝试基于&lt;strong&gt; JavaType&lt;/strong&gt; 和&lt;strong&gt; JdbcType&lt;/strong&gt; 去匹配 *&lt;br&gt;
&lt;em&gt;TypeHandler&lt;/em&gt;*。&lt;/p&gt;
&lt;p&gt;所以本质上就算没有通过&lt;strong&gt; javaType&lt;/strong&gt; 指定&lt;strong&gt; JavaType&lt;/strong&gt;，&amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 标签和 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  参数占位符都是能够拿到&lt;strong&gt; JavaType&lt;/strong&gt;，只不过 &amp;lt;*&lt;br&gt;
&lt;em&gt;result&lt;/em&gt;*&amp;gt; 标签在构建&lt;strong&gt; ResultMapping&lt;/strong&gt; 时就能够拿到&lt;strong&gt; JavaType&lt;/strong&gt;，而 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  参数占位符需要在&lt;strong&gt; SQL&lt;/strong&gt; 语句实际执行前为 *&lt;br&gt;
&lt;em&gt;PreparedStatement&lt;strong&gt; 设置参数时才能够拿到&lt;/strong&gt; JavaType&lt;/em&gt;*。&lt;/p&gt;
&lt;p&gt;那么按照本节的结论，为什么第四节最后的&lt;strong&gt;例子 1&lt;/strong&gt; 中的 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  使用不到&lt;strong&gt; ListStringTypeHandler&lt;/strong&gt; 呢，这是因为在为 *&lt;br&gt;
&lt;em&gt;PreparedStatement&lt;strong&gt; 设置参数时，&lt;strong&gt;studentIntention&lt;/strong&gt; 这个参数的实际类型是&lt;/strong&gt; ArrayList&lt;/em&gt;*，而不是&lt;strong&gt; List&lt;/strong&gt;，但在&lt;strong&gt; MyBatis&lt;/strong&gt; 中，认为&lt;br&gt;
&lt;strong&gt; ListStringTypeHandler&lt;/strong&gt; 是支持&lt;strong&gt; List&lt;/strong&gt; 而不是&lt;strong&gt; ArrayList&lt;/strong&gt; 的。&lt;/p&gt;
&lt;h2 id=&#34;总结&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#总结&#34;&gt;#&lt;/a&gt; 总结&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;TypeHandler&lt;/strong&gt; 能够帮助完成&lt;strong&gt; Java&lt;/strong&gt; 类型到&lt;strong&gt; Jdbc&lt;/strong&gt; 类型的相互转换，对于常规的转换，&lt;strong&gt;MyBatis&lt;/strong&gt; 提供了内置的&lt;strong&gt; TypeHandler&lt;/strong&gt;&lt;br&gt;
，而对于非常规的转换，需要自定义&lt;strong&gt; TypeHandler&lt;/strong&gt;。自定义方式有两种，如下所示。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;实现&lt;strong&gt; TypeHandler&lt;/strong&gt; 接口；&lt;/li&gt;
&lt;li&gt;继承&lt;strong&gt; BaseTypeHandler&lt;/strong&gt; 抽象类。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;更推荐使用继承&lt;strong&gt; BaseTypeHandler&lt;/strong&gt; 抽象类的方式来自定义&lt;strong&gt; TypeHandler&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;自定义的&lt;strong&gt; TypeHandler&lt;/strong&gt; 有如下两种方式被使用。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;显示使用。在 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 标签或者 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  中通过&lt;strong&gt; typeHandler&lt;/strong&gt; 属性指定要使用的&lt;strong&gt; TypeHandler&lt;/strong&gt;；&lt;/li&gt;
&lt;li&gt;隐式使用。通过 &amp;lt;&lt;strong&gt;result&lt;/strong&gt; &amp;gt; 标签或者 &lt;code&gt;#&amp;#123;&amp;#125;&lt;/code&gt;  的&lt;strong&gt; JavaType&lt;/strong&gt; 和&lt;strong&gt; JdbcType&lt;/strong&gt;，由&lt;strong&gt; MyBatis&lt;/strong&gt; 推断出需要使用的&lt;strong&gt; TypeHandler&lt;/strong&gt;。&lt;/li&gt;
&lt;/ol&gt;
 ]]></description>
        </item>
    </channel>
</rss>
